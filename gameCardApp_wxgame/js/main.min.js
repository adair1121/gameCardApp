function post(t,e,i){var n=i.value,r=t.constructor.name+MessageCenter.splite+e,s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=n.call.apply(n,[this].concat(t));return("boolean"!=typeof i||i)&&MessageCenter.inst().dispatch(r,i),i};return s.funcallname=r,i.value=s,i}function callLater(t,e,i){var n=i.value,r="$"+e+"CL",s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];delete this[r],n.call.apply(n,[this].concat(t))},o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this[r]||(egret.callLater.apply(egret,[s,this].concat(t)),this[r]=!0)};return i.value=o,i}function callDelay(t){var e=function(e,i,n){var r=n.value,s="$isDelay"+i,o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this[s]=!1,r.call.apply(r,[this].concat(t))},a=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this[s]||(this[s]=!0,egret.setTimeout.apply(egret,[o,this,t].concat(e)))};return n.value=a,n};return e}var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{h(n.next(t))}catch(e){s(e)}}function a(t){try{h(n["throw"](t))}catch(e){s(e)}}function h(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(o,a)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,s&&(o=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){h.label=i[1];break}if(6===i[0]&&h.label<o[1]){h.label=o[1],o=i;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(i);break}o[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],s=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,o,a,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},BaseClass=function(){function t(){}return t.single=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;if(!i._instance){var n=t.length;0==n?i._instance=new i:1==n?i._instance=new i(t[0]):2==n?i._instance=new i(t[0],t[1]):3==n?i._instance=new i(t[0],t[1],t[2]):4==n?i._instance=new i(t[0],t[1],t[2],t[3]):5==n&&(i._instance=new i(t[0],t[1],t[2],t[3],t[4]))}return i._instance},t}();__reflect(BaseClass.prototype,"BaseClass");var BaseEntity=function(t){function e(){var e=t.call(this)||this;return e._dic=3,e._hp=40,e._thp=40,e._attack=20,e._changeValue=.1,e._isDead=!1,e.buffAttack=0,e.buffHp=0,e.buffDef=0,e.scale=1,e.initialize(),e}return __extends(e,t),e.prototype.initialize=function(){},Object.defineProperty(e.prototype,"camp",{get:function(){return this._camp},set:function(t){this._camp=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instId",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dic",{get:function(){return this._dic},set:function(t){this._dic=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attack",{get:function(){var t=100*Math.random()>>0,e=t>=50?1:-1;return this._attack+this.buffAttack+e*((this._attack+this.buffAttack)*this._changeValue)},set:function(t){this._attack=t},enumerable:!0,configurable:!0}),e.prototype.getIndex=function(){return 100*Math.random()>>0>50?1:-1},e.prototype.reduceHp=function(t){if(this.buffHp>0)this.buffHp-=t;else{var e=(.2*parseInt(t)>>0)*this.getIndex(),i=parseInt(t)-this.buffDef+e;this._hp-=i,this._hp<=0&&(this._hp=0,this._isDead=!0);var n=new eui.BitmapLabel;n.scaleX=n.scaleY=.7,n.font="dmg_fnt",this.parent&&this.parent.addChildAt(n,this.parent.numChildren-1),n.text="-"+i,n.x=this.x,n.y=this.y+-100+(50*Math.random()>>0),egret.Tween.get(n).to({y:this.y-150},600+(400*Math.random()>>0),egret.Ease.circIn).call(function(){egret.Tween.removeTweens(n),n&&n.parent&&n.parent.removeChild(n)},this)}},e.prototype.calculEntityDic=function(t){t>=-90&&0>t||t>=0&&90>=t?this._dic=1:this._dic=-1,this.scaleX=this._dic*this.scale*-this.camp},e.prototype.dispose=function(){},e}(eui.Component);__reflect(BaseEntity.prototype,"BaseEntity");var BaseEuiView=function(t){function e(){var e=t.call(this)||this;return e.removed=!1,e.skinName=egret.getQualifiedClassName(e)+"Skin",e.percentHeight=100,e.percentWidth=100,e}return __extends(e,t),e.prototype.ins=function(){var t=this;return this._instance||(this._instance=new t),this._instance},e.prototype.showClose=function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=null),void 0===n&&(n=null),this.closeBtn=new eui.Image,this.closeBtn.source="close_btn_png",this.addChild(this.closeBtn),this.closeBtn.top=60,this.closeBtn.right=30,this.addTouchEvent(this.closeBtn,function(){ViewManager.inst().close(t),i&&n&&i.call(n)},!0)},e.prototype.onRouteFront=function(t){},e.prototype.addToParent=function(t){t.addChild(this)},e.prototype.refreshPage=function(){},e.prototype.removeFromeParent=function(){this&&this.parent&&(this.close(),this.parent.removeChild(this))},e.prototype.addTouchEvent=function(t,e,i){void 0===i&&(i=!1),i&&(t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginTouch,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onEndTouch,this),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEndTouch,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEndTouch,this)),this.addEvent(egret.TouchEvent.TOUCH_TAP,t,e)},e.prototype.onBeginTouch=function(t){t.target&&this.changeFilter(t.target)},e.prototype.onEndTouch=function(t){t.target&&t.target.filters&&(t.target.filters=[])},e.prototype.changeFilter=function(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]},e.prototype.removeTouchEvent=function(t,e){t&&t.removeEventListener(egret.TouchEvent.TOUCH_TAP,e,this),t.hasEventListener("touchBegin")&&t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginTouch,this),t.hasEventListener("touchEnd")&&t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEndTouch,this),t.hasEventListener("touchCancel")&&t.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEndTouch,this),t.hasEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE)&&t.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEndTouch,this)},e.prototype.addEvent=function(t,e,i){return e?void e.addEventListener(t,i,this):void console.log("不存在绑定对象")},e}(eui.Component);__reflect(BaseEuiView.prototype,"BaseEuiView");var BaseView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.addTouchEvent=function(t,e,i){void 0===i&&(i=!1),this.addEvent(egret.TouchEvent.TOUCH_TAP,t,e),i&&(t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginTouch,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onEndTouch,this),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEndTouch,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEndTouch,this))},e.prototype.onBeginTouch=function(t){t.target&&this.changeFilter(t.target)},e.prototype.onEndTouch=function(t){t.target&&t.target.filters&&(t.target.filters=[])},e.prototype.changeFilter=function(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]},e.prototype.addTouchEndEvent=function(t,e){this.addEvent(egret.TouchEvent.TOUCH_END,t,e)},e.prototype.addChangeEvent=function(t,e){var i=this;t&&t instanceof eui.TabBar?this.addEvent(egret.TouchEvent.CHANGE,t,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.call.apply(e,[i].concat(t))}):this.addEvent(egret.TouchEvent.CHANGE,t,e)},e.prototype.addChangingEvent=function(t,e){this.addEvent(egret.TouchEvent.CHANGING,t,e)},e.prototype.addEvent=function(t,e,i){return e?void e.addEventListener(t,i,this):void debug.error("不存在绑定对象")},e.prototype.removeTouchEvent=function(t,e){t&&(t.removeEventListener(egret.TouchEvent.TOUCH_TAP,e,this),t.hasEventListener("touchBegin")&&t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginTouch,this),t.hasEventListener("touchEnd")&&t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEndTouch,this),t.hasEventListener("touchCancel")&&t.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEndTouch,this),t.hasEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE)&&t.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEndTouch,this))},e.prototype.$onClose=function(){var t=function(i){for(var n=0;n<i.numChildren;n++){var r=i.getChildAt(n);r instanceof e?r.$onClose():r instanceof egret.DisplayObjectContainer&&t(r)}};t(this)},e}(eui.Component);__reflect(BaseView.prototype,"BaseView");var MessageCenter=function(t){function e(e){var i=t.call(this)||this;return i.flag=0,i.type=e,i.dict={},i.eVec=[],0==i.type&&egret.startTick(i.run,i),i}return __extends(e,t),e.prototype.clear=function(){this.dict={},this.eVec.splice(0)},e.prototype.addListener=function(t,e,i){var n=this.dict[t];n?0!=this.flag&&(this.dict[t]=n=n.concat()):this.dict[t]=n=[];for(var r=0,s=n;r<s.length;r++){var o=s[r];if(o[0]==e&&o[1]==i)return}n.push([e,i])},e.prototype.removeListener=function(t,e,i){var n=this.dict[t];if(n){0!=this.flag&&(this.dict[t]=n=n.concat());for(var r=n.length,s=0;r>s;s++)if(n[s][0]==e&&n[s][1]==i){n.splice(s,1);break}0==n.length&&(this.dict[t]=null,delete this.dict[t])}},e.prototype.removeAll=function(t){for(var e=Object.keys(this.dict),i=0,n=e;i<n.length;i++){var r=n[i],s=this.dict[r];0!=this.flag&&(this.dict[r]=s=s.concat());for(var o=s.length,a=o-1;a>=0;a--)s[a][1]==t&&s.splice(a,1);0==s.length&&(this.dict[r]=null,delete this.dict[r])}},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=new MessageVo;n.type=t,n.param=e,0==this.type?this.eVec.push(n):1==this.type?this.dealMsg(n):debug.log("MessageCenter未实现的类型")},e.prototype.run=function(t){for(var e=egret.getTimer();this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-e>5)););return!1},e.inst=function(){var e=t.single.call(this);return e},e.prototype.dealMsg=function(t){var e=this.dict[t.type];if(e){var i=e.length;if(0!=i){this.flag++;for(var n=0,r=e;n<r.length;n++){var s=r[n];s[0].apply(s[1],t.param)}this.flag--,t.dispose()}}},e.setFunction=function(t,i,n,r){if(0==n.indexOf(r)&&"function"==typeof i[n]){var s=egret.getQualifiedClassName(i)+e.splite+n+e.msgIndex;e.msgIndex+=1;var o=i[n],a=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var r;i.length;return r=t?o.call.apply(o,[this].concat(i)):o.apply(void 0,i),("boolean"!=typeof r||r)&&e.inst().dispatch(s,r),r};return a.funcallname=s,i[n]=a,!0}return!1},e.compile=function(t,i){void 0===i&&(i="post");var n=t.prototype;for(var r in n)e.setFunction(!0,n,r,i)},e.addListener=function(t,i,n,r){return void 0===r&&(r=void 0),t.funcallname?(e.inst().addListener(t.funcallname,i,n),r&&t.call(r),!0):(debug.log("MessageCenter.addListener error:"+egret.getQualifiedClassName(n)),!1)},e.splite=".",e.msgIndex=1,e}(BaseClass);__reflect(MessageCenter.prototype,"MessageCenter");var MessageVo=function(){function t(){}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();__reflect(MessageVo.prototype,"MessageVo");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,TimerManager.inst().doTimer(6e4,0,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),i=0,n=e.length;n>i;i++){var r=e[i];this.checkCanClear(r)&&t-this._cache[r]>=SoundManager.CLEAR_TIME&&(delete this._cache[r],RES.destroyRes(r))}},t.prototype.getSound=function(t,e,i){var n=this;RES.getResByUrl(t,function(r){var s=r;if(s)n._cache[t]&&(n._cache[t]=egret.getTimer());else{if(-1!=n._loadingCache.indexOf(t))return null;n._loadingCache.push(t),RES.getResAsync(t,n.onResourceLoadComplete,n)}e&&i&&e.call(i,s)},this,RES.ResourceItem.TYPE_SOUND)},t.prototype.onResourceLoadComplete=function(t,e){var i=this._loadingCache.indexOf(e);-1!=i&&(this._loadingCache.splice(i,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var StartGameEvent=function(t){function e(e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=!1),void 0===r&&(r=!1);var s=t.call(this,e,n,r)||this;return s.data=i,s}return __extends(e,t),e.START="start",e.VJ_END="vjEnd",e.GAMELOADINGEND="gameloadingend",e.REMOVE_ITEM="remove_item",e.CLICK_GUIDE_SKILL="click_guide_skill",e.USE_GUIDE_SKILL="use_guide_skill",e}(egret.Event);__reflect(StartGameEvent.prototype,"StartGameEvent");var LayerManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.iniaizlize=function(t){t.addChild(e.MAP_LAYER),e.MAP_LAYER.name="layer_map",e.MAP_LAYER.touchThrough=!0,t.addChild(e.UNIT_LAYER),e.UNIT_LAYER.touchThrough=!0,t.addChild(e.EFFECT_LAYER),e.EFFECT_LAYER.name="layer_effect",e.EFFECT_LAYER.touchEnabled=!0,t.addChild(e.UI_Main),e.UI_Main.name="layer_main",e.UI_Main.touchThrough=!0,t.addChild(e.UI_MAIN_NAV),e.UI_MAIN_NAV.touchThrough=!0,t.addChild(e.UI_Pop),e.UI_Pop.name="layer_pop",e.UI_Pop.touchThrough=!0,t.addChild(e.TIPS_LAYER),e.TIPS_LAYER.touchThrough=!0},e.inst=function(){var e=t.single.call(this);return e},e.MAP_LAYER=new eui.UILayer,e.UNIT_LAYER=new eui.UILayer,e.EFFECT_LAYER=new eui.UILayer,e.UI_Main=new eui.UILayer,e.UI_MAIN_NAV=new eui.UILayer,e.UI_Pop=new eui.UILayer,e.TIPS_LAYER=new eui.UILayer,e}(BaseClass);__reflect(LayerManager.prototype,"LayerManager");var ViewManager=function(t){function e(){var e=t.call(this)||this;return e._regesterInfo={},e._views=[],e}return __extends(e,t),e.inst=function(){var e=t.single.call(this);return e},e.prototype.getKey=function(t){for(var e="",i=Object.keys(this._regesterInfo),n=0,r=i.length;r>n;n++){var s=i[n];if(this._regesterInfo[s][0]==t){e=s;break}}return e},e.prototype.isExistView=function(t){for(var e=0;e<this._views.length;e++)if(this._views[e]instanceof t)return{view:this._views[e],index:e};return null},e.prototype.reg=function(t,e){if(null!=t){var i=egret.getQualifiedClassName(t);this._regesterInfo[i]||(this._regesterInfo[i]=[t,e])}},e.prototype.open=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1);var n=this.getKey(t);if(n){var r=this._regesterInfo[n],s=this.isExistView(r[0]),o=s?s.view:null,a=s?s.index-1:0;if(null==o?(o=new r[0],o.addToParent(r[1]),o.open.apply(o,e),this._views.push(o)):o.refreshPage&&o.refreshPage.apply(o,e),i){var h=this._views[a];h&&(h.left=0,egret.Tween.get(h).to({left:-100},500,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(h)},this)),o.left=o.width,egret.Tween.get(o).to({left:0},500,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(o)},this)}}else console.log("当前界面未注册----"+t)},e.prototype.getView=function(t){var e=this.getKey(t),i=this._regesterInfo[e],n=this.isExistView(i[0]),r=n?n.view:null;return r},e.prototype.closeReturnEffect=function(t,e,i){var n=this;void 0===e&&(e=!1),void 0===i&&(i=null);var r=this.getKey(t);if(r){var s=this._regesterInfo[r],o=this.isExistView(s[0]),a=o?o.index:0,h=this._views[a],l=this._views[a-1];if(h&&egret.Tween.get(h).to({left:h.width},500,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(h),e&&n.close(t)},this),i){var c=this.getKey(i);if(c){var u=this._regesterInfo[c],p=this.isExistView(u[0]),g=-1;p&&(g=p.index),-1!=g&&(l=this._views[g])}}l&&(l.refreshPage&&l.refreshPage(),egret.Tween.get(l).to({left:0},500,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(l)}))}},e.prototype.close=function(t){var e=this.getKey(t);if(e){var i=this._regesterInfo[e],n=this.isExistView(i[0]);if(!n)return null;var r=n?n.index:0,s=this._views[r];if(null==s)return null;this._views.splice(r,1),s.removeFromeParent()}else console.log("当前界面未注册----"+t)},e}(BaseClass);__reflect(ViewManager.prototype,"ViewManager");var GameMap=function(){function t(){}return t.init=function(e){var i=e.grids;t.grid=[],t.runGrid=[],t.CELL_SIZE=e.gridw,t.MAX_WIDTH=e.pixwidth,t.MAX_HEIGHT=e.pixheight,t.COL=e.cols,t.ROW=e.rows,this.AstarNode=new astar.Grid(e.cols,e.rows);for(var n=0;n<e.rows;n++){t.grid[n]=[];for(var r=0;r<e.cols;r++){if(t.grid[n][r]=i[n*e.cols+r],1==t.grid[n][r]){var s={row:n,col:r};t.runGrid.push(s)}0==t.grid[n][r]&&this.AstarNode.setWalkable(r,n,!1)}}},t.point2Grid=function(e,i){var n=e/t.CELL_SIZE>>0,r=i/t.CELL_SIZE>>0;return{x:n,y:r}},t.grid2Point=function(e,i){var n=e*t.CELL_SIZE,r=i*t.CELL_SIZE;return{x:n,y:r}},t.calculBuildGridArea=function(e){for(var i=Math.ceil(e.width/t.CELL_SIZE),n=Math.ceil(e.height/t.CELL_SIZE),r=[],s=t.point2Grid(e.x,e.y),o=0;i>o;o++)for(var a=0;n>a;a++){var h={x:s.x+o,y:s.y+a};r.push(h)}return r},t.walkable=function(e,i){if(!t.grid[i])return null;if(isNaN(t.grid[i][e]))return null;var n=t.grid[i][e];return 3==n?null:n},t.buildTouch=!1,t.grid=[],t.runGrid=[],t}();__reflect(GameMap.prototype,"GameMap");var GameApp=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.inst=function(){var e=t.single.call(this);return e},e.prototype.load=function(){eui.Label.default_fontFamily="Microsoft YaHei",LoadingUI.inst().hide(),ViewManager.inst().open(GameMainView),ViewManager.inst().open(StartGameView);var t=egret.localStorage.getItem(LocalStorageEnum.ROLE_GOLD);t?e.roleGold=parseInt(t):e.roleGold=800;var i=egret.localStorage.getItem(LocalStorageEnum.ROLE_GEM);i?e.roleGem=parseInt(i):e.roleGem=10;var n=egret.localStorage.getItem(LocalStorageEnum.REBORNIDS);n?e.reborns=JSON.parse(n):e.reborns={};var r=egret.localStorage.getItem(LocalStorageEnum.REBORNCFG);r&&(e.skillCfg=JSON.parse(r));var s=egret.localStorage.getItem(LocalStorageEnum.LEVEL);s?e.level=parseInt(s):e.level=1,eui.Binding.bindHandler(e,["level"],this.levelChange,this),recharge.sendToNativeLoadEnd()},e.prototype.levelChange=function(){egret.localStorage.setItem(LocalStorageEnum.LEVEL,e.level.toString())},e.prototype.onDataCallBack=function(t){t&&(e.phurseState=!1,e.pay_cbDdata="",UserTips.inst().showTips("购买成功,获得元宝x"+t))},e.prototype.refreshTimespan=function(){var t=egret.localStorage.getItem(LocalStorageEnum.BOX_REFRESH_TIMESPAN);if(t){var e=(new Date).getTime();e>=parseInt(t)&&(egret.localStorage.setItem(LocalStorageEnum.BOX_REWARD_GET,"0"),egret.localStorage.setItem(LocalStorageEnum.BOX_REFRESH_TIMESPAN,"0"),egret.localStorage.setItem(LocalStorageEnum.BOX_REFRESH_TIMESPAN,GlobalFun.getBoxRfreshTimeSpan().toString()))}else egret.localStorage.setItem(LocalStorageEnum.BOX_REFRESH_TIMESPAN,GlobalFun.getBoxRfreshTimeSpan().toString())},Object.defineProperty(e.prototype,"gold",{get:function(){return e.roleGold},set:function(t){e.roleGold=t,egret.localStorage.setItem(LocalStorageEnum.ROLE_GOLD,t.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gem",{get:function(){return e.roleGem},set:function(t){e.roleGem=t,egret.localStorage.setItem(LocalStorageEnum.ROLE_GEM,t.toString())},enumerable:!0,configurable:!0}),e.prototype.postPerLoadProgress=function(t,e){return[t,e]},e.phurseState=!1,e.roleGold=0,e.roleGem=0,e.reborns={},e.level=1,e.totalCount=5,e.bgMusic=.5,e.effectMusic=.5,e.gameaEnd=!0,e}(BaseClass);__reflect(GameApp.prototype,"GameApp"),MessageCenter.compile(GameApp);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var h=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var GameConfig;!function(t){var e;!function(t){t.setting="ios"}(e=t.platform||(t.platform={}))}(GameConfig||(GameConfig={}));var GlobalConfig=function(){function t(){}return t.setData=function(t){this.config=t},t.parserData=function(){if(!this.init&&this.config){var e=function(e){var n=i.config[e],r=egret.getDefinitionByName(e);if(r){var s="_obj"+e;i[s]=new r;var o="_bool"+e;i[o]=!1;var a="_"+e+"_";Object.defineProperty(i,e,{get:function(){var i=this[a];if(this[o])return i;var n=this[s];return this.parseKeys(i,n,t.keys[e]||0),this[o]=!0,i},set:function(t){this[a]=t}})}i[e]=n},i=this;for(var n in this.config)e(n);this.init=!0,this.config=null}},t.parseKeys=function(t,e,i){if(0==i)t.__proto__=e;else for(var n in t)this.parseKeys(t[n],e,i-1)},t.keys={},t}();__reflect(GlobalConfig.prototype,"GlobalConfig");var GuideCfg=function(){function t(){}return t.guidecfg={"1_1":{event:StartGameEvent.CLICK_GUIDE_SKILL,next:"1_2",param:{id:"1_2"}},"1_2":{event:StartGameEvent.USE_GUIDE_SKILL,next:"",param:{skillId:100002}}},t}();__reflect(GuideCfg.prototype,"GuideCfg");var MonsterCfg=function(){function t(){}return t.cfgs=[{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:1,skillId:0,model:"monster_1"},{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:2,skillId:0,model:"monster_2"},{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:3,skillId:0,model:"monster_3"},{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:4,skillId:0,model:"monster_4"},{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:5,skillId:0,model:"monster_5"},{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:6,skillId:0,model:"monster_6"},{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:7,skillId:0,model:"monster_7"},{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:8,skillId:0,model:"monster_8"},{name:"名字",level:1,atktype:1,atkDis:100,type:1,spd:60,atk:100,hp:500,id:9,skillId:0,model:"monster_9"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:10,skillId:0,model:"s_monster_1"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:11,skillId:0,model:"s_monster_2"},,{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:12,skillId:0,model:"s_monster_3"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:13,skillId:0,model:"s_monster_4"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:14,skillId:0,model:"s_monster_5"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:15,skillId:0,model:"s_monster_6"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:16,skillId:0,model:"s_monster_7"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:17,skillId:0,model:"s_monster_8"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:18,skillId:0,model:"s_monster_9"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:19,skillId:0,model:"s_monster_10"},{name:"名字",level:1,atktype:1,atkDis:100,type:2,spd:60,atk:100,hp:500,id:20,skillId:0,model:"s_monster_11"}],t}();__reflect(MonsterCfg.prototype,"MonsterCfg");var RebornCfg=function(){function t(){}return t.cfg=[{cost:0,mid:1,name:"神将",level:1,atktype:1,atkDis:50,type:1,spd:100,atk:50,hp:500,id:4,skillId:0,model:"skill_103_1",skillType:1,atkspd:6,desc:"神将"},{cost:1500,mid:2,name:"剑圣",level:1,rmodel:1,atktype:1,atkDis:50,type:1,spd:100,atk:50,hp:500,id:4,skillId:0,model:"skill_103_2",skillType:1,atkspd:6,desc:"攻速暴增200%"},{cost:2e3,mid:3,name:"天尊",level:1,atktype:1,atkDis:50,rmodel:3,type:1,spd:100,atk:50,hp:500,id:4,skillId:0,model:"skill_103_3",skillType:1,atkspd:6,desc:"全属性增加1倍"},{cost:2500,mid:4,name:"法神",level:1,atktype:1,atkDis:200,rmodel:2,type:1,spd:100,atk:50,hp:500,id:4,skillId:0,model:"skill_103_4",skillType:1,atkspd:6,desc:"攻击力增幅4倍"}],t}();__reflect(RebornCfg.prototype,"RebornCfg");var ShopCfg=function(){function t(){}return t.shopCfg=[[{cost:6,costNum:600,shopId:"0_1",desc:"600金",icon_title:"gold_font_1_png",icon:"goldIcon_1_png"},{cost:30,costNum:3e3,shopId:"0_2",desc:"3000金",icon_title:"gold_font_2_png",icon:"goldIcon_2_png"},{cost:68,costNum:6800,shopId:"0_3",desc:"6800金",icon_title:"gold_font_3_png",icon:"goldIcon_3_png"},{cost:128,costNum:12800,shopId:"0_4",desc:"12800金",icon_title:"gold_font_4_png",icon:"goldIcon_4_png"},{cost:328,costNum:32800,shopId:"0_5",desc:"32800金",icon_title:"gold_font_5_png",icon:"goldIcon_5_png"}]],t}();__reflect(ShopCfg.prototype,"ShopCfg");var SkillCfg=function(){function t(){}return t.skillCfg=[{skillId:101,skillIcon:"skill_101_png",skillTitle:"skill_101_title_png",desc:"连续点击怪物攻击",cd:40,time:3,level:1,cost:30,atk:5,skillType:0,buffTime:10},{skillId:102,skillIcon:"skill_102_png",skillTitle:"skill_102_title_png",desc:"按住屏幕划动",cd:40,time:3,level:1,cost:30,atk:5,skillType:0,buffTime:5},{skillId:103,skillIcon:"skill_103_png",skillTitle:"skill_103_title_png",desc:"点击战场召唤",cd:0,time:0,num:10,level:1,cost:100,atk:50,skillType:0,buffTime:0},{skillId:104,skillIcon:"skill_104_png",skillTitle:"skill_104_title_png",desc:"选择攻击区域",cd:60,time:0,level:1,cost:100,atk:20,skillType:0,buffTime:0},{skillId:105,skillIcon:"skill_105_png",skillTitle:"skill_105_title_png",desc:"刷新技能cd",cd:0,time:0,level:1,cost:0,skillType:0,buffTime:0}],t}();__reflect(SkillCfg.prototype,"SkillCfg");var recharge;!function(t){function e(t){r&&s&&r.call(s,t)}function i(t,i,n){window.callBack=e,r=i,s=n,window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.funciap&&window.webkit.messageHandlers.funciap.postMessage(t)}function n(){window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.loadingFinish&&window.webkit.messageHandlers.loadingFinish.postMessage({})}var r,s;t.sendToNativePhurse=i,t.sendToNativeLoadEnd=n}(recharge||(recharge={}));var astar;!function(t){var e=function(){function t(){this._straightCost=1,this._diagCost=Math.SQRT2,this._heuristic=this.diagonal}return t.prototype.findPath=function(t){return this._grid=t,this._open=[],this._closed=[],this._startNode=this._grid.startNode,this._endNode=this._grid.endNode,this._startNode.g=0,this._startNode.h=this._heuristic(this._startNode),this._startNode.f=this._startNode.g+this._startNode.h,this.search()},t.prototype.search=function(){for(var t=this._startNode;t!=this._endNode;){for(var e=Math.max(0,t.x-1),i=Math.min(this._grid.numCols-1,t.x+1),n=Math.max(0,t.y-1),r=Math.min(this._grid.numRows-1,t.y+1),s=e;i>=s;s++)for(var o=n;r>=o;o++){var a=this._grid.getNode(s,o);if(a!=t&&a.walkable&&this._grid.getNode(t.x,a.y).walkable&&this._grid.getNode(a.x,t.y).walkable){var h=this._straightCost;t.x!=a.x&&t.y!=a.y&&(h=this._diagCost);var l=t.g+h*a.costMultiplier,c=this._heuristic(a),u=l+c;this.isOpen(a)||this.isClosed(a)?a.f>u&&(a.f=u,a.g=l,a.h=c,a.parent=t):(a.f=u,a.g=l,a.h=c,a.parent=t,this._open.push(a))}}for(var p=0;p<this._open.length;p++);if(this._closed.push(t),0==this._open.length)return console.log("AStar >> no path found"+this._endNode),!1;for(var g=this._open.length,d=0;g>d;d++)for(var f=d+1;g>f;f++)if(this._open[d].f>this._open[f].f){var _=this._open[d];this._open[d]=this._open[f],this._open[f]=_}t=this._open.shift()}return this.buildPath(),!0},t.prototype.buildPath=function(){this._path=new Array;var t=this._endNode;for(this._path.push(t);t!=this._startNode;)t=t.parent,this._path.unshift(t)},Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),t.prototype.isOpen=function(t){for(var e=0;e<this._open.length;e++)if(this._open[e]==t)return!0;return!1},t.prototype.isClosed=function(t){for(var e=0;e<this._closed.length;e++)if(this._closed[e]==t)return!0;return!1},t.prototype.manhattan=function(t){return Math.abs(t.x-this._endNode.x)*this._straightCost+Math.abs(t.y+this._endNode.y)*this._straightCost},t.prototype.euclidian=function(t){var e=t.x-this._endNode.x,i=t.y-this._endNode.y;return Math.sqrt(e*e+i*i)*this._straightCost},t.prototype.diagonal=function(t){var e=Math.abs(t.x-this._endNode.x),i=Math.abs(t.y-this._endNode.y),n=Math.min(e,i),r=e+i;return this._diagCost*n+this._straightCost*(r-2*n)},Object.defineProperty(t.prototype,"visited",{get:function(){return this._closed.concat(this._open)},enumerable:!0,configurable:!0}),t}();t.AStar=e,__reflect(e.prototype,"astar.AStar")}(astar||(astar={}));var astar;!function(t){var e=function(){function e(e,i){this._numCols=e,this._numRows=i,this._nodes=[];for(var n=0;e>n;n++){this._nodes[n]=[];for(var r=0;i>r;r++)this._nodes[n][r]=new t.Node(n,r)}}return e.prototype.getNode=function(t,e){return this._nodes[t][e]},e.prototype.setEndNode=function(t,e){this._endNode=this._nodes[t][e]},e.prototype.setStartNode=function(t,e){this._startNode=this._nodes[t][e]},e.prototype.setWalkable=function(t,e,i){this._nodes[t][e].walkable=i},Object.defineProperty(e.prototype,"endNode",{get:function(){return this._endNode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numCols",{get:function(){return this._numCols},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numRows",{get:function(){return this._numRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startNode",{get:function(){return this._startNode},enumerable:!0,configurable:!0}),e}();t.Grid=e,__reflect(e.prototype,"astar.Grid")}(astar||(astar={}));var astar;!function(t){var e=function(){function t(t,e){this.walkable=!0,this.costMultiplier=1,this.x=t,this.y=e}return t}();t.Node=e,__reflect(e.prototype,"astar.Node")}(astar||(astar={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this.removeSoundChannel(this._currSoundChannel),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t){var e=this;this._currBg!=t&&(this.stop(),this._currBg=t,this.getSound(t,function(t){e.playSound(t)},this))},e.prototype.touchPlay=function(){if(this._currSoundChannel&&this._currSound){var t=this._currSoundChannel.position;this.removeSoundChannel(this._currSoundChannel),this._currSoundChannel=this._currSound.play(t,1),this.addSoundChannel(this._currSoundChannel)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,1),this.addSoundChannel(this._currSoundChannel)},e.prototype.onSoundComplete=function(){this._currSoundChannel&&this.removeSoundChannel(this._currSoundChannel),this.playSound(this._currSound)
},e.prototype.addSoundChannel=function(t){t.volume=this._volume,t.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)},e.prototype.removeSoundChannel=function(t){t.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),t.stop()},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){if(this._currBg==t){var e=RES.getRes(t);if(!e)return;this.playSound(e)}},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){var e=t.call(this)||this;return e._loaded=!1,e}return __extends(e,t),e.prototype.play=function(t){var e=this;this._loaded=!0,this.getSound(t,function(t){t&&(e._sound=t,e.playSound(e._sound))},this)},e.prototype.stop=function(){this._soundChannel&&this._soundChannel.stop()},e.prototype.playSound=function(t){this._soundChannel&&this._soundChannel.stop(),this._soundChannel=t.play(0,1),this._soundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){var e=RES.getRes(t);e&&this.playSound(e)},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e.bgOn=!0,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=.5,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.inst=function(){var e=t.single.call(this);return e},e.prototype.playEffect=function(t){this.effectOn&&this.effect.play(t)},e.prototype.stopEffect=function(){this.effectOn&&this.effect.stop()},e.prototype.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.touchBg=function(){egret.Capabilities.isMobile&&"iOS"==egret.Capabilities.os&&this.bg.touchPlay()},e.prototype.setEffectOn=function(t){this.effectOn=t},e.prototype.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}(BaseClass);__reflect(SoundManager.prototype,"SoundManager");var BitmapNumber=function(t){function e(){var e=t.call(this)||this;return e._imgPool=[],e._containerPool=[],e}return __extends(e,t),e.prototype.createNumPic=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var r,s=this.getContainer(),o=t.toString(),a=0;for(a;a<o.length;a++)r=this.getSingleNumPic(o.charAt(a),e),s.addChild(r);return this.repositionNumPic(s,i,n),s},e.prototype.desstroyNumPic=function(t){this.clearContainer(t),t.parent&&t.parent.removeChild(t),this._containerPool.push(t)},e.prototype.changeNum=function(t,e,i,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var s=e.toString();if(t){if(t.numChildren>s.length)for(;t.numChildren>s.length;)this.recycleBM(t.getChildAt(t.numChildren-1));var o,a=0;for(a;a<s.length;a++)a>=t.numChildren&&t.addChild(this.getBitmap()),o=s.charAt(a),o="."==o?"dot":o,t.getChildAt(a).texture=this.getTexture(o,i);this.repositionNumPic(t,n,r)}},e.prototype.repositionNumPic=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n,r=0,s=0;for(r;r<t.numChildren;r++)n=t.getChildAt(r),n.x=s-e,s=n.x+n.width},e.prototype.clearContainer=function(t){for(;t.numChildren;)this.recycleBM(t.getChildAt(t.numChildren-1))},e.prototype.recycleBM=function(t){t&&t.parent&&(t.parent.removeChild(t),t.texture=null,this._imgPool.push(t))},e.prototype.getContainer=function(){return this._containerPool.length?this._containerPool.shift():new egret.DisplayObjectContainer},e.prototype.getSingleNumPic=function(t,e){"."==t&&(t="dot");var i=this.getBitmap();return i.texture=this.getTexture(t,e),i},e.prototype.getTexture=function(t,e){return RES.getRes(e+t+"_png")},e.prototype.getBitmap=function(){return this._imgPool.length?this._imgPool.shift():new egret.Bitmap},e}(BaseClass);__reflect(BitmapNumber.prototype,"BitmapNumber");var MovieClip=function(t){function e(){var e=t.call(this)||this;return e.rate=1,e.pixelHitTest=!1,e._mcFactory=new egret.MovieClipDataFactory,e}return __extends(e,t),e.prototype.playFile=function(t,i,n,r,s,o,a){var h=this;if(void 0===i&&(i=1),void 0===n&&(n=null),void 0===r&&(r=!0),void 0===s&&(s=""),-1==t.indexOf("chargeff1")&&-1==t.indexOf("forceguildeff")&&-1==t.indexOf("qianghua")&&-1==t.indexOf("forgeSuccess")&&-1==t.indexOf("neigongbaozhaeff")&&-1==t.indexOf("piaodongqipaohuang")){if(this.time=egret.getTimer(),this._compFun=n,this._loadFun=o,this.playCount=i,this.remove=r,TimerManager.inst().remove(this.playComp,this),this.texture&&null==this.texture.bitmapData);else if(this.name==t)return void this.createBody(s,a);this.name=t,this.texture&&e.removeDisplayObject(this,this.texture.bitmapData),this.jsonData=null,this.texture=null,RES.getResByUrl(this.name+".json",function(t,e){h.name+".json"==e&&t&&(h.jsonData=t,h.createBody(s,a))},this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(this.name+".png",function(t,i){h.name+".png"==i&&t&&(h.texture=t,h.stage&&e.addDisplayObject(h,h.texture.bitmapData),h.createBody(s,a))},this,RES.ResourceItem.TYPE_IMAGE)}},e.prototype.$onAddToStage=function(i,n){t.prototype.$onAddToStage.call(this,i,n),this.texture&&e.addDisplayObject(this,this.texture.bitmapData)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.texture&&e.removeDisplayObject(this,this.texture.bitmapData)},e.prototype.createBody=function(t,i){if(void 0===t&&(t=""),this.jsonData&&this.texture){this._mcFactory.clearCache(),this._mcFactory.mcDataSet=this.jsonData,this._mcFactory.texture=this.texture;var n=this.name.split("/"),r=n.pop();this.movieClipData=this._mcFactory.generateMovieClipData(r),this.name in e.originalRate||(e.originalRate[this.name]=this.movieClipData.frameRate),this.frameRate=i?i:e.originalRate[this.name]*this.rate>>0;try{this.gotoAndPlay(t?t:1,this.playCount)}catch(s){console.warn("错误动画文件:",this.name)}if(this.playCount>0){var o=egret.getTimer()-this.time;o=this.playTime*this.playCount-o,o>0?TimerManager.inst().doTimer(o,1,this.playComp,this):this.playComp()}this._loadFun&&this._loadFun(),this.dispatchEventWith(egret.Event.CHANGE)}},e.prototype.playComp=function(){this.stage&&this._compFun&&this._compFun(),this.remove&&DisplayUtils.removeFromParent(this)},Object.defineProperty(e.prototype,"playTime",{get:function(){return this.movieClipData?1/this.frameRate*this.totalFrames*1e3:0},enumerable:!0,configurable:!0}),e.prototype.clearComFun=function(){this._compFun=null},e.prototype.dispose=function(){this.stop(),this.resetMovieClip(),this.clearComFun(),TimerManager.inst().removeAll(this)},e.prototype.destroy=function(){DisplayUtils.removeFromParent(this),this.dispose()},e.prototype.resetMovieClip=function(){var t=this;t.rotation=0,t.scaleX=1,t.scaleY=1,t.alpha=1,t.anchorOffsetX=0,t.anchorOffsetY=0,t.x=0,t.y=0,t.rate=1,t.$renderNode.cleanBeforeRender(),t._mcFactory.clearCache(),t._mcFactory.mcDataSet=null,t._mcFactory.texture=null,t.name=null,t.jsonData=null,t.filters=null;var i=t.texture;i&&e.removeDisplayObject(t,i.bitmapData),t.texture=null,t.remove=!1,egret.Tween.removeTweens(t)},e.addDisplayObject=function(t,i){if(i){var n=i.hashCode;if(!e.displayList[n])return void(e.displayList[n]=[t]);var r=e.displayList[n];r.indexOf(t)<0&&r.push(t)}},e.removeDisplayObject=function(t,i){if(i){var n=i.hashCode;if(e.displayList[n]){var r=e.displayList[n],s=r.indexOf(t);s>=0&&r.splice(s,1),0==r.length&&delete e.displayList[n]}}},e.originalRate={},e.displayList=egret.createMap(),e}(egret.MovieClip);__reflect(MovieClip.prototype,"MovieClip");var SoldierEntity=function(t){function e(){var e=t.call(this)||this;return e.curState=ActionState.STAND,e.ObjectPoolKey="SoldierEntity",e.general=!1,e.camp=1,e.restriceAtk=0,e.atkFrame=6,e.battleState=!1,e.isReleaseSkill=!1,e.playState=!1,e.isInAtk=!1,e}return __extends(e,t),e.prototype.initialize=function(){},e.prototype.setSoldierData=function(t,e,i){this._camp=t,this.camp=t,this.soldierAttr=i,this.scaleX=this.scaleY=.7,this.scale=.7,-1!=this._camp||this.general||("s_monster_6"!=this._res&&"s_monster_5"!=this._res?(this.scaleX=this.scaleY=.6,this.scale=.6):(this.scaleX=this.scaleY=.9,this.scale=.9)),1==this.camp&&"monster_8"!=e&&(this.scaleX=this.scaleY=.5,this.scale=.5),this.hp=this.thp=this.soldierAttr.hp;var n=100*Math.random()>>0>50?1:-1;this.soldierAttr.atkDis+=(10*Math.random()>>0)*n,this._direc=1==this._camp?1:-1,1==t?this._res=""+SKILL+e:this._res=""+MONSTER+e,this._mc=new MovieClip,this.addChild(this._mc),this._mc.playFile(this._res,-1,null,!1,this.curState),this.progressGroup=new eui.Group,this.progressGroup.anchorOffsetX=40,this.progressGroup.width=80,this.addChild(this.progressGroup),this.progressGroup.horizontalCenter=0,this.progressGroup.y=-130,1==this.camp;var r=1==t?65280:16528436,s=new egret.Shape;if(s.anchorOffsetX=40,s.graphics.beginFill(r,1),s.graphics.drawRect(0,0,80,10),s.graphics.endFill(),this._barimg=s,this.progressGroup.addChild(s),this.general&&(this.progressGroup.y=-200),-1==this._camp&&this.general){var o=new eui.Image,a=21*Math.random()+1>>0;o.source="title_"+a+"_png",o.scaleX=o.scaleY=1,this.progressGroup.addChild(o),o.anchorOffsetX=o.width>>1,o.anchorOffsetY=o.height,o.y=-20}this._watcher=eui.Binding.bindHandler(this,["_hp"],this.onHpChange,this)},e.prototype.onHpChange=function(t){if(!isNaN(t)){var e=t/this._thp;if(this._barimg){this._barimg.graphics.clear();var i=1==this.camp?65280:16528436;this._barimg.graphics.beginFill(i,1),this._barimg.graphics.drawRect(0,0,80*e,10),this._barimg.graphics.endFill()}}},e.prototype.execAtkAction=function(){if(this.isInAtkDis()&&!this.battleState&&this.curState!=ActionState.ATTACK){this.curState=ActionState.ATTACK,egret.Tween.removeTweens(this),this.battleState=!0;var t=900;if(1==this.camp&&this.soldierAttr.atkspd&&this.soldierAttr.atkspd>6&&(t>>=1,this.atkFrame=24),this._atkTar&&!this._atkTar.isDead){var e=180*Math.atan2(this._atkTar.y-this.y,this._atkTar.x-this.x)/Math.PI;this.calculEntityDic(e)}if(this._mc.playFile(this._res,1,null,!1,this.curState,null,this.atkFrame),4==this.soldierAttr.id)var i=setTimeout(function(){if(clearTimeout(i),n&&n._mc){var t=new MovieClip;t.scaleX=t.scaleY=.8,t.playFile(SKILL_EFF+"skill_fs",1,null,!0),n.addChild(t),t.x=n._mc.x,t.y=n._mc.y,-1==n.scaleX&&(t.scaleX=-.8)}},600);var n=this,r=setTimeout(function(){if(n.battleState=!1,clearTimeout(r),n&&n._mc&&(n.curState=ActionState.STAND,n._mc.playFile(n._res,-1,null,!1,n.curState)),n&&n._atkTar){var t=15*Math.random()+5>>0,e=100*Math.random()>>0>=50?-1:1,i=n.soldierAttr.atk-n.restriceAtk+e*t;n._atkTar.reduceHp(i);var s=new MovieClip;s.playFile(SKILL_EFF+"hurt",1,null,!0),n.parent.addChild(s),s.x=n._atkTar.x,s.y=n._atkTar.y}else-1==n._camp&&n.x>=StageUtils.inst().getWidth()-200&&MessageManager.inst().dispatch(CustomEvt.REDUCE_HP,{hp:n.soldierAttr.atk,camp:n.camp})},t)}},e.prototype.createArrow=function(){var t=new eui.Image;t.source="arrow_png",this.parent.addChild(t),t.anchorOffsetX=20,t.scaleX=-this.camp;var e=180*Math.atan2(this.atkTar.y-this.y,this.atkTar.x-this.x)/Math.PI;t.rotation=e,t.x=this.x,t.y=this.y-(this.h>>1),egret.Tween.get(t).to({x:this._atkTar.x,y:this._atkTar.y},400).call(function(){egret.Tween.removeTweens(t),t.parent.removeChild(t)},this)},e.prototype.waitMoveAction=function(){this.battleState=!1,this.curState!=ActionState.RUN&&(this.curState=ActionState.RUN,this._mc.playFile(this._res,-1,null,!1,this.curState)),egret.Tween.removeTweens(this)},e.prototype.execYmoveAction=function(t){egret.Tween.removeTweens(this),this.curState!=ActionState.RUN&&(this.curState=ActionState.RUN,this._mc.playFile(this._res,-1,null,!1,this.curState)),egret.Tween.get(this).to({y:t},600).call(function(){})},e.prototype.execMoveAction=function(t,e,i,n){var r=this;if(void 0===n&&(n=!0),this.battleState=!1,t){var s=180*Math.atan2(t.y-this.y,t.x-this.x)/Math.PI;this.calculEntityDic(s),this.curState!=ActionState.RUN&&(this.curState=ActionState.RUN,this._mc.playFile(this._res,-1,null,!1,this.curState));var o=new egret.Point(this.x,this.y),a=new egret.Point(t.x,t.y),h=Math.sqrt(Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2)),l=h/this.soldierAttr.spd;egret.Tween.removeTweens(this),egret.Tween.get(this,{loop:!1,onChange:function(){r.judgeIfInView()},onChangeObj:this}).to({x:t.x,y:t.y},1e3*l).call(function(){egret.Tween.removeTweens(r),r.curState=ActionState.STAND,r._mc&&r._mc.playFile(r._res,-1,null,!1,r.curState),e&&i&&e.call(i)})}else if(this&&this._atkTar&&!this._atkTar.isDead){var s=180*Math.atan2(this._atkTar.y-this.y,this._atkTar.x-this.x)/Math.PI;this.calculEntityDic(s),this.curState!=ActionState.RUN&&(this.curState=ActionState.RUN,this._mc&&this._mc.playFile(this._res,-1,null,!1,this.curState));var o=new egret.Point(this.x,this.y),a=new egret.Point(this._atkTar.x,this._atkTar.y),h=Math.sqrt(Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2));egret.Tween.removeTweens(this);var l=h/this.soldierAttr.spd;egret.Tween.get(this,{loop:!1,onChange:function(){r.judgeIfInView(),r.isInAtkDis()&&egret.Tween.removeTweens(r)},onChangeObj:this}).to({x:this._atkTar.x,y:this._atkTar.y},1e3*l).call(function(){egret.Tween.removeTweens(r)})}},e.prototype.judgeIfInView=function(){if(1!=this._camp&&!this.isReleaseSkill&&this.general){var t=100+(100*Math.random()>>0);return this.x>=t?(this.isReleaseSkill=!0,this.playAtkAction(4),MessageManager.inst().dispatch(CustomEvt.BOSS_RELEASESKILL,{xy:{x:this.x,y:this.y}}),!0):!1}},e.prototype.execStandAction=function(){this.battleState=!1,this.curState=ActionState.STAND,this._mc.playFile(this._res,-1,null,!1,this.curState)},e.prototype.playAtkAction=function(t){egret.Tween.removeTweens(this),this.curState=ActionState.ATTACK,this._mc.playFile(this._res,-1,null,!1,this.curState,null,t);var e=new MovieClip;if(this&&this.parent){this.parent.addChild(e),e.playFile(EFFECT+"release",3),e.x=this.x,e.y=this.y-50,this.playState=!0;var i=this,n=setTimeout(function(){clearTimeout(n),i.playState=!1},1500)}},e.prototype.execOneTimeAtk=function(t,e,i){this.curState=ActionState.ATTACK,this._mc.playFile(this._res,1,null,!1,this.curState,null);var n=this,r=setTimeout(function(){clearTimeout(r),n.curState=ActionState.STAND,n._mc.playFile(n._res,1,null,!1,n.curState,null),t.call(e,i)},600)},e.prototype.isInAtkDis=function(){if(this&&this._atkTar&&!this._atkTar.isDead){var t=new egret.Point(this.x,this.y),e=new egret.Point(this._atkTar.x,this._atkTar.y),i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));return Math.abs(i)<=this.soldierAttr.atkDis}return this.isInAtk},e.prototype.lookAt=function(t,e){return void 0===e&&(e=!1),e?void(this._atkTar=t):void((!this._atkTar||this._atkTar&&this._atkTar._isDead)&&(this._atkTar=t))},e.prototype.unlookAt=function(){this._atkTar=null},Object.defineProperty(e.prototype,"isDead",{get:function(){return this._isDead},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(-1==this._camp){var e=new MovieClip;e.playFile(EFFECT+"gold",1,null,!0),this.parent.addChild(e),e.x=this.x,e.y=this.y,GameApp.inst().gold+=4*Math.random()+2>>0}t._atkTar=null,t&&t._mc&&(t.removeChild(t._mc),t._mc=null),t&&t.parent&&t.parent.removeChild(t)},Object.defineProperty(e.prototype,"hp",{set:function(t){this._hp=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thp",{set:function(t){this._thp=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"atkTar",{get:function(){return this._atkTar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffAtk",{set:function(t){this.buffAttack=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffHP",{set:function(t){this.buffHp=t},enumerable:!0,configurable:!0}),e}(BaseEntity);__reflect(SoldierEntity.prototype,"SoldierEntity");var SoldierShapeEntity=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.inst=function(){var e=t.single.call(this);return e},e.prototype.initData=function(t,e,i,n,r,s,o){this._shapeType=t,t==SoldierShapType.TYPE_CIRCLE&&(r.y+=80),this.w=this.h=60,this._res=e,this._id=i,this._parent=n,this._baseXY=r,this._cb=s,this._arg=o,this.arr=[],this.onCreateShape()},e.prototype.onCreateShape=function(){switch(this._shapeType){case SoldierShapType.TYPE_CIRCLE:this.createCircle(),this._cb&&this._arg&&this._cb.call(this._arg,this.arr);break;case SoldierShapType.TYPE_CROSS:this.createCross(),this._cb&&this._arg&&this._cb.call(this._arg,this.arr);break;case SoldierShapType.TYPE_HALFCIRCLE:this.createHalfCircle(),this._cb&&this._arg&&this._cb.call(this._arg,this.arr);break;case SoldierShapType.TYPE_RECT:this.createRect(),this._cb&&this._arg&&this._cb.call(this._arg,this.arr);break;case SoldierShapType.TYPE_TIXING:this.createTiXing(),this._cb&&this._arg&&this._cb.call(this._arg,this.arr);break;case SoldierShapType.TYPE_TRIANGLE:this.createTriangle(5,0,0,-100),this._cb&&this._arg&&this._cb.call(this._arg,this.arr)}},e.prototype.createRect=function(t,e,i,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var s=4,o=4;e&&(s=e),i&&(o=i);for(var a=0;s>a;a++)for(var h=0;o>h;h++){var l=this.createShape();this._parent.addChild(l),this.arr.push(l),l.x=h*(this.w+10)+n+this._baseXY.x,l.y=a*(this.h+10)+r+this._baseXY.y,t&&(l.rotation=t)}},e.prototype.createCircle=function(){for(var t=200,e=[0,45,90,135,180,-45,-90,-135],i=0;1>i;i++){t-=100;for(var n=0;n<e.length;n++){var r=Math.cos(e[n]*Math.PI/180)*t,s=Math.sin(e[n]*Math.PI/180)*t,o=this.createShape();this._parent.addChild(o),this.arr.push(o),o.x=r+this._baseXY.x,o.y=s+this._baseXY.y+50}}},e.prototype.createHalfCircle=function(){for(var t=200,e=[-90,-45,0,45,90],i=0;2>i;i++){for(var n=0;n<e.length;n++){var r=Math.cos(e[n]*Math.PI/180)*t,s=Math.sin(e[n]*Math.PI/180)*t,o=this.createShape();this._parent.addChild(o),this.arr.push(o),o.x=r+this._baseXY.x,o.y=s+this._baseXY.y+70}t-=100}},e.prototype.createTriangle=function(t,e,i,n){void 0===t&&(t=5),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);for(var r=t,s=0,o=0;t-1>o;o++){r-=1,s+=40;for(var a=1;r>=a;a++){var h=this.createShape();this._parent.addChild(h),this.arr.push(h),h.y=a*(this.h+10)+s-i+this._baseXY.y+n,h.x=o*(this.w+10)+e+this._baseXY.x}}},e.prototype.createTiXing=function(){for(var t=6,e=0,i=0;6>i&&(t-=1,!(2>=t));i++){e+=30;for(var n=1;t>=n;n++){var r=this.createShape();this._parent.addChild(r),this.arr.push(r),r.y=n*(this.h+10)+e+this._baseXY.y-130,r.x=i*(this.w+10)+this._baseXY.x}}},e.prototype.createArrow=function(){this.createRect(null,2,3),this.createTriangle(4,210,160)},e.prototype.createCross=function(){this.createRect(null,3,4)},e.prototype.createShape=function(){var t=new SoldierEntity,e=GlobalFun.getCardDataFromId(this._id);return t.setSoldierData(-1,this._res,e),t},e}(BaseClass);__reflect(SoldierShapeEntity.prototype,"SoldierShapeEntity");var ActionState=function(){function t(){}return t.RUN="run",t.ATTACK="attack",t.DEAD="dead",t.STAND="stand",t.HIT="hit",t}();__reflect(ActionState.prototype,"ActionState");var SoldierShapType;!function(t){t[t.TYPE_RECT=0]="TYPE_RECT",t[t.TYPE_CIRCLE=1]="TYPE_CIRCLE",t[t.TYPE_HALFCIRCLE=2]="TYPE_HALFCIRCLE",t[t.TYPE_TRIANGLE=3]="TYPE_TRIANGLE",t[t.TYPE_TIXING=4]="TYPE_TIXING",t[t.TYPE_CROSS=5]="TYPE_CROSS"}(SoldierShapType||(SoldierShapType={}));var LocalStorageEnum=function(){function t(){}return t.ENTER_FIRST="enter_first",t.IS_PASS_GUIDE="is_pass_guide",t.LEVEL="level",t.BOX_REWARD_GET="box_reward_get",t.BOX_REWARD_TIMESPAN="box_reward_timespan",t.BOX_REFRESH_TIMESPAN="box_refresh_timespan",t.ROLE_GOLD="role_gold",t.ROLE_GEM="role_gem",t.SKILL_LEVEL="skill_level",t.REBORNIDS="rebornIds",t.REBORNCFG="rebornCfg",t}();__reflect(LocalStorageEnum.prototype,"LocalStorageEnum");var RES_RESOURCE="http://yidianhaoranqi.top/resource/",EFFECT="http://yidianhaoranqi.top/resource/res/animate/",SKILL=EFFECT+"skill103/",MONSTER="http://yidianhaoranqi.top/resource/res/animate/monster/",MAP_DIR=RES_RESOURCE+"map/",CFG_DIR=RES_RESOURCE+"config/",DEFAULT_FONT=RES_RESOURCE+"res/font/yt.ttf",RES_AUDIO="http://yidianhaoranqi.top/resource/res/audio/",SKILL_EFF=EFFECT+"skill/",CustomEvt=function(t){function e(e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=!1),void 0===r&&(r=!1);var s=t.call(this,e,n,r)||this;return s._data=i,s}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.GAMELOADINGEND="gameLoadingEnd",e.REDUCE_HP="reducehp",e.BOSS_RELEASESKILL="boos_releaseskill",e.REBORNSUCCESS="rebornsuccess",e.CANCLESKILLCDPAUSE="cancleskillcdpause",e}(egret.Event);__reflect(CustomEvt.prototype,"CustomEvt");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.inst=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.hide=function(){this.parent&&(this.visible=!1,this.parent.removeChild(this))},e.prototype.createView=function(){var t=this,e=setTimeout(function(){clearTimeout(e),t.visible=!0},300),i=new eui.Rect;this.addChild(i),i.alpha=.3,i.left=0,i.right=0,i.top=0,i.bottom=0,this.progressPanel=new eui.Group,this.addChild(this.progressPanel),this._w=StageUtils.inst().getWidth()-200,this.progressPanel.horizontalCenter=0,this.progressPanel.verticalCenter=0,this.progressBg=new eui.Image,this.progressBg.source="progress_bg_png",this.progressPanel.addChild(this.progressBg),this.progressBg.horizontalCenter=0,this.progressBg.verticalCenter=0,this.progressBar=new eui.Image,this.progressBar.source="progress_bar_png",this.progressBar.horizontalCenter=0,this.progressBar.verticalCenter=0,this.progressPanel.addChild(this.progressBar),this.progressMask=new eui.Rect,this.progressMask.height=110,this.progressMask.width=104,this.progressPanel.addChild(this.progressMask),this.progressMask.x=138-(this.progressMask.width>>1),this.progressMask.bottom=83,this.progressBar.mask=this.progressMask,this.textField=new eui.Label,this.progressPanel.addChild(this.textField),this.textField.fontFamily="yt",this.textField.size=20,this.textField.bottom=0,this.textField.horizontalCenter=0,this.percentTxt=new eui.Label,this.progressPanel.addChild(this.percentTxt),this.percentTxt.fontFamily="yt",this.percentTxt.size=20,this.percentTxt.verticalCenter=0,this.percentTxt.horizontalCenter=0;var n=new MovieClip;this.addChild(n),n.playFile(EFFECT+"circle",-1),n.x=StageUtils.inst().getWidth()>>1,n.y=StageUtils.inst().getHeight()>>1,n.scaleX=n.scaleY=3},e.prototype.onProgress=function(t,e){var i=t/e*110;0>=i&&(i=0),this.percentTxt.text=(t/e*100>>0)+"%",this.progressMask.height=i},e}(eui.UILayer);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var VJEvent=function(t){function e(e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=null),void 0===r&&(r=!1);var s=t.call(this,e,i,r)||this;return s.data=n,s}return __extends(e,t),e.VJ_START="vj_start",e.VJ_END="vj_end",e.VJ_MOVE="vj_move",e}(egret.Event);__reflect(VJEvent.prototype,"VJEvent");var IBaseEuiView=function(){function t(){}return t}();__reflect(IBaseEuiView.prototype,"IBaseEuiView");var DelayOptManager=function(t){function e(){var e=t.call(this)||this;return e.TIME_THRESHOLD=2,e._delayOpts=[],egret.startTick(e.runCachedFun,e),e}return __extends(e,t),e.inst=function(){var e=t.single.call(this);return e},e.prototype.addDelayOptFunction=function(t,e,i,n,r){this._delayOpts.push({fun:e,funPara:i,thisObj:t,callBack:n,para:r})},e.prototype.clear=function(){this._delayOpts.length=0},e.prototype.runCachedFun=function(t){if(0==this._delayOpts.length)return!1;for(var e,i=egret.getTimer();this._delayOpts.length&&(e=this._delayOpts.shift(),e.funPara?e.fun.call(e.thisObj,e.funPara):e.fun.call(e.thisObj),e.callBack&&(void 0!=e.para?e.callBack.call(e.thisObj,e.para):e.callBack()),!(egret.getTimer()-i>this.TIME_THRESHOLD)););return!1},e}(BaseClass);__reflect(DelayOptManager.prototype,"DelayOptManager");var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),StageUtils.init(),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){};var i=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",i),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),wx.showToast({title:"加载中",icon:"loading",image:"http://yidianhaoranqi.top/resource/assets/bg.jpg"}),wx.getSystemInfo({success:function(t){var i=wx.createUserInfoButton({type:"text",text:"获取用户信息",style:{left:t.screenWidth/2-100,top:t.screenHeight/2,width:200,height:40,lineHeight:40,backgroundColor:"#f7f7f7",color:"#000000",textAlign:"center",fontSize:16,borderRadius:4}});i.onTap(function(t){i.destroy(),""!=t.signature&&t.userInfo&&t.userInfo.nickName&&e.runGame()["catch"](function(t){console.log(t)})})},fail:function(){},complete:function(){}})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=i.sent(),this.startAnimation(t),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return e=i.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,RES.loadConfig("default.res.json","http://yidianhaoranqi.top/resource/")];case 1:return e.sent(),[4,this.loadTheme()];case 2:return e.sent(),this.stage.addChild(LoadingUI.inst()),[4,RES.loadGroup("preload",0,LoadingUI.inst())];case 3:return e.sent(),[3,5];case 4:return t=e.sent(),console.error(t),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){eui.Button.prototype.autoSize=eui.Image.prototype.autoSize=eui.Rect.prototype.autoSize=eui.Group.prototype.autoSize=function(){var t=StageUtils.inst().getWidth()/1136,e=StageUtils.inst().getHeight()/640;this.scaleX=this.scaleY=t,this.x*=t,this.y*=e},eui.Rect.prototype.changeSize=function(){var t=StageUtils.inst().getWidth()/1136,e=StageUtils.inst().getHeight()/640;this.width*=t,this.height*=e,this.x*=t,this.y*=e};var t=GlobalFun.getOption("pf");platform?GameConfig.platform.setting=t:GameConfig.platform.setting="ios";new eui.Image;GameApp.inst().refreshTimespan(),LayerManager.inst().iniaizlize(this),GameApp.inst().load()},e.prototype.startAnimation=function(t){},e}(eui.UILayer);__reflect(Main.prototype,"Main");var MessageManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.inst=function(){var t=this.single();return t},e.prototype.dispatch=function(t,e){var i=new CustomEvt(t,e);StageUtils.inst().getStage().dispatchEvent(i)},e.prototype.addListener=function(t,e,i){StageUtils.inst().getStage().addEventListener(t,e,i)},e.prototype.removeListener=function(t,e,i){StageUtils.inst().getStage().removeEventListener(t,e,i)},e}(BaseClass);__reflect(MessageManager.prototype,"MessageManager");var TimerManager=function(t){function e(){var e=t.call(this)||this;return e.currHandler=null,e._handlers=[],e.nexthandles=null,e._currTime=egret.getTimer(),e._currFrame=0,egret.startTick(e.onEnterFrame,e),e}return __extends(e,t),e.inst=function(){var e=t.single.call(this);return e},e.prototype.getFrameId=function(){return this._currFrame},e.prototype.getCurrTime=function(){return this._currTime},e.binFunc=function(t,e){return t.exeTime>e.exeTime?-1:t.exeTime<e.exeTime?1:0},e.DeleteHandle=function(t){t.clear()},e.prototype.onEnterFrame=function(t){this._currFrame++,this._currTime=egret.getTimer();var i=0,n=this.nexthandles;if(this.nexthandles=null,n&&n.length>0){for(var r=0,s=n;r<s.length;r++){var o=s[r];o.method.call(o.methodObj),e.DeleteHandle(o)}n=null}if(this._handlers.length<=0)return!1;for(var a=this._handlers[this._handlers.length-1];a.exeTime<=this._currTime;){this.currHandler=a=this._handlers.pop(),a.method.call(a.methodObj),i=egret.getTimer(),a.exeTime=i+a.delay;var h=a.forever;if(h||(a.repeatCount>1?(a.repeatCount--,h=!0):a.onFinish&&a.onFinish.apply(a.finishObj)),h){var l=Algorithm.binSearch(this._handlers,a,e.binFunc);this._handlers.splice(l,0,a)}else e.DeleteHandle(a);if(i-this._currTime>5)break;if(this._handlers.length<=0)break;a=this._handlers[this._handlers.length-1]}return this.currHandler=null,!1},e.prototype.create=function(t,i,n,r,s,o,a){if(!(0>i||0>n||null==r)){var h=new TimerHandler;h.forever=0==n,h.repeatCount=n,h.delay=i,h.method=r,h.methodObj=s,h.onFinish=o,h.finishObj=a,h.exeTime=t+this._currTime;var l=Algorithm.binSearch(this._handlers,h,e.binFunc);this._handlers.splice(l,0,h)}},e.prototype.doTimer=function(t,e,i,n,r,s){void 0===r&&(r=null),void 0===s&&(s=null),this.create(t,t,e,i,n,r,s)},e.prototype.doTimerDelay=function(t,e,i,n,r,s,o){void 0===s&&(s=null),void 0===o&&(o=null),this.create(t,e,i,n,r,s,o)},e.prototype.doNext=function(t,e){var i=new TimerHandler;i.method=t,i.methodObj=e,this.nexthandles||(this.nexthandles=[]),this.nexthandles.push(i)},e.prototype.remove=function(t,i){var n=this.currHandler;n&&n.method==t&&n.methodObj==i&&(n.forever=!1,n.repeatCount=0);for(var r=this._handlers.length-1;r>=0;r--){var s=this._handlers[r];s.method==t&&s.methodObj==i&&(this._handlers.splice(r,1),e.DeleteHandle(s))}},e.prototype.removeAll=function(t){var i=this.currHandler;i&&i.methodObj==t&&(i.forever=!1,i.repeatCount=0);for(var n=this._handlers.length-1;n>=0;n--){var r=this._handlers[n];r.methodObj==t&&(this._handlers.splice(n,1),e.DeleteHandle(r))}},e.prototype.isExists=function(t,e){for(var i=0,n=this._handlers;i<n.length;i++){var r=n[i];if(r.method==t&&r.methodObj==e)return!0}return!1},e}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.forever=!1,this.repeatCount=0,this.exeTime=0}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.onFinish=null,this.finishObj=null,this.forever=!1},t}();__reflect(TimerHandler.prototype,"TimerHandler");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var GameLoadingUI=function(t){function e(){var e=t.call(this)||this;return e.total=100,e.cur=0,e}return __extends(e,t),e.prototype.open=function(){for(var t=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];this.proBar.mask=this.barMask,this.progressLab.text="0%请稍候...";var r=setInterval(function(){t.cur+=5,t.cur>=t.total&&(t.cur=t.total,clearInterval(r),i&&i[0]&&(i[0].cb&&i[0].arg&&i[0].cb.call(i[0].arg),i[0].param&&(t._param=i[0].param),i[0].cls&&ViewManager.inst().open(i[0].cls,[t._param]),i[0].closeCls&&ViewManager.inst().close(i[0].closeCls)),StageUtils.inst().getStage().dispatchEvent(new StartGameEvent(StartGameEvent.GAMELOADINGEND)),ViewManager.inst().close(e));var n=t.cur/t.total*100>>0;t.progressLab.text=n+"%请稍候...",t.barMask.height=t.cur/t.total*206},100)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e}(BaseEuiView);__reflect(GameLoadingUI.prototype,"GameLoadingUI"),ViewManager.inst().reg(GameLoadingUI,LayerManager.UI_Pop);
var MapViewBg=function(t){function e(){var e=t.call(this)||this;return e._shape=new egret.Shape,e.lastUpdateX=0,e.lastUpdateY=0,e.turn=0,e.touchChildren=!1,e.touchEnabled=!1,e._imageList=[],e.showImages=[],e._poolImages=[],e._fileDic={},e.updateHDMap(MAP_DIR+"/"),e}return __extends(e,t),e.prototype.clearHDMap=function(){this._imageList=[],this.showImages=[],this.removeChildren()},e.prototype.getImage=function(){return this._poolImages.pop()||new eui.Image},e.prototype.updateHDMap=function(t){this.clear();var e=256;this.maxImagX=Math.ceil(GameMap.MAX_WIDTH/e),this.maxImagY=Math.ceil(GameMap.MAX_HEIGHT/e);for(var i=0;i<this.maxImagX;i++)for(var n=0;n<this.maxImagY;n++){var r=""+t+i+"_"+n+".jpg",s=this.getImage();s.source=r,s.name=r,s.x=i*e,s.y=n*e,this.addChild(s)}},e.prototype.clear=function(){this.clearHDMap()},e}(egret.DisplayObjectContainer);__reflect(MapViewBg.prototype,"MapViewBg");var Algorithm=function(){function t(){}return t.sortAsc=function(t,e){return e>t?-1:t>e?1:0},t.sortAscAttr=function(e,i,n){var r;if(void 0==n)r=t.sortAsc(e,i);else{var s=e[n],o=i[n];r=o>s?-1:s>o?1:0}return r},t.sortDesc=function(t,e){return t>e?-1:e>t?1:0},t.sortDescAttr=function(e,i,n){var r;if(void 0==n)r=t.sortDesc(e,i);else{var s=e[n],o=i[n];r=s>o?-1:o>s?1:0}return r},t.binSearch=function(e,i,n){if(void 0===n&&(n=null),!e||0==e.length)return 0;n||(n=t.sortAsc);for(var r=0,s=e.length-1;s>=r;){var o=s+r>>1,a=e[o];n(a,i)<=0?r=o+1:s=o-1}return r},t.test=function(){for(var e=[],i=10,n=0;i>n;n++){var r=Math.floor(1e5*Math.random()),s=t.binSearch(e,r);e.splice(s,0,r)}e.length!=i&&debug.log("test fail!count is "+e.length+", except:"+i);for(var o=0,a=e;o<a.length;o++){var h=a[o];debug.log(h)}for(var n=0;n<e.length-1;n++)if(e[n]>e[n+1]){debug.log("test fail!index:"+n);break}},t}();__reflect(Algorithm.prototype,"Algorithm");var AverageUtils=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}return t.prototype.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},t.prototype.getValue=function(){return this.numSum/this.numsLen},t.prototype.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();__reflect(AverageUtils.prototype,"AverageUtils");var Base64=function(){function t(){}return t.base64encode=function(t){var e,i,n,r,s,o;for(n=t.length,i=0,e="";n>i;){if(r=255&t.charCodeAt(i++),i==n){e+=this.base64EncodeChars.charAt(r>>2),e+=this.base64EncodeChars.charAt((3&r)<<4),e+="==";break}if(s=t.charCodeAt(i++),i==n){e+=this.base64EncodeChars.charAt(r>>2),e+=this.base64EncodeChars.charAt((3&r)<<4|(240&s)>>4),e+=this.base64EncodeChars.charAt((15&s)<<2),e+="=";break}o=t.charCodeAt(i++),e+=this.base64EncodeChars.charAt(r>>2),e+=this.base64EncodeChars.charAt((3&r)<<4|(240&s)>>4),e+=this.base64EncodeChars.charAt((15&s)<<2|(192&o)>>6),e+=this.base64EncodeChars.charAt(63&o)}return e},t.base64decode=function(t){var e,i,n,r,s,o,a;for(o=t.length,s=0,a="";o>s;){do e=this.base64DecodeChars[255&t.charCodeAt(s++)];while(o>s&&-1==e);if(-1==e)break;do i=this.base64DecodeChars[255&t.charCodeAt(s++)];while(o>s&&-1==i);if(-1==i)break;a+=String.fromCharCode(e<<2|(48&i)>>4);do{if(n=255&t.charCodeAt(s++),61==n)return a;n=this.base64DecodeChars[n]}while(o>s&&-1==n);if(-1==n)break;a+=String.fromCharCode((15&i)<<4|(60&n)>>2);do{if(r=255&t.charCodeAt(s++),61==r)return a;r=this.base64DecodeChars[r]}while(o>s&&-1==r);if(-1==r)break;a+=String.fromCharCode((3&n)<<6|r)}return a},t.base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t.base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],t}();__reflect(Base64.prototype,"Base64");var ColorUtil=function(){function t(){}return t.mergeARGB=function(t,e,i,n){return t<<24|e<<16|i<<8|n},t.getChannel=function(t,e){switch(e){case this.ALPHA:return t>>24&255;case this.RED:return t>>16&255;case this.GREEN:return t>>8&255;case this.BLUE:return 255&t}return 0},t.numberToString=function(t,e){return void 0===e&&(e="#"),e+t.toString(16)},t.ALPHA=4080082432,t.RED=15937822,t.GREEN=3532333,t.BLUE=255,t.NORMAL_COLOR=13746831,t.RED_COLOR_N=15937822,t.GREEN_COLOR_N=3532333,t.GRAY_COLOR2=8618883,t.WHITE_COLOR2=13746831,t.WHITE_COLOR="#D1C28F",t.RED_COLOR="#F3311E",t.GREEN_COLOR="#35E62D",t.GRAY_COLOR="#8B898B",t.COLOR_STR=["white","green","purple","orange","red","golden"],t.ROLENAME_COLOR_YELLOW=16764427,t.ROLENAME_COLOR_GREEN=3532333,t.ROLENAME_COLOR_NORMAL=3532333,t.JUEWEI_COLOR=["#e2dfd4","#35e62d","#81adff","#e27dff","#ff9649","#fc5959","#ffd93f","#ffff00"],t}();__reflect(ColorUtil.prototype,"ColorUtil");var DateStyle=function(t){function e(e,i,n,r){var s=t.call(this)||this;return s.format=[],s.from=0,s.to=0,s.isFormatNum=!1,s.format=e,s.from=i,s.to=n,s.isFormatNum=r,s}return __extends(e,t),e}(BaseClass);__reflect(DateStyle.prototype,"DateStyle");var DateUtils=function(){function t(){}return t.getFormatTimeByStyle=function(e,i){if(void 0===i&&(i=t.STYLE_1),0>e&&(e=0,debug.log("输入参数有误!时间为负数:"+e)),i.from>i.to)return debug.log("输入参数有误!to参数必须大于等于from参数,请检查style参数的值"),"";e>>=0;for(var n="",r=i.to;r>=i.from;r--){var s=e/this.mul[r],o="";r!=i.to&&(s%=this.mod[r]),o=i.isFormatNum&&10>s?"0"+(s>>0).toString():(s>>0).toString(),n+=o+i.format[r]}return n},t.getFormatTimeByStyle1=function(e,i){return void 0===i&&(i=t.STYLE_1),this.getFormatTimeByStyle(e/this.MS_PER_SECOND)},t.formatMiniDateTime=function(e){return t.MINI_DATE_TIME_BASE+(2147483647&e)*t.MS_PER_SECOND},t.formatServerTime=function(e){return(e-t.MINI_DATE_TIME_BASE)/t.MS_PER_SECOND},t.getFormatBySecond=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=2);var n="",r=1e3*t;switch(e){case this.TIME_FORMAT_1:n=this.format_1(r);break;case this.TIME_FORMAT_2:n=this.format_2(r);break;case this.TIME_FORMAT_3:n=this.format_3(r);break;case this.TIME_FORMAT_4:n=this.format_4(r);break;case this.TIME_FORMAT_5:n=this.format_5(r,i);break;case this.TIME_FORMAT_6:n=this.format_6(r);break;case this.TIME_FORMAT_7:n=this.format_7(r);break;case this.TIME_FORMAT_8:n=this.format_8(r);break;case this.TIME_FORMAT_9:n=this.format_9(r);break;case this.TIME_FORMAT_10:n=this.format_10(r);break;case this.TIME_FORMAT_11:n=this.format_11(r);break;case this.TIME_FORMAT_12:n=this.format_12(r);break;case this.TIME_FORMAT_13:n=this.format_13(r);break;case this.TIME_FORMAT_14:n=this.format_14(r);break;case this.TIME_FORMAT_15:n=this.format_15(r)}return n},t.getRenainSecond=function(e){var i=e?new Date(e):new Date,n=t.getTodayZeroSecond(i)+86400-i.getTime()/1e3;return n.toFixed(0)},t.getTodayPassedSecond=function(){var t=new Date,e=((Date.now()-new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime())/1e3).toFixed(0);return parseInt(e)},t.getTodayZeroSecond=function(t){var e=t?t:new Date;return parseInt((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()/1e3).toFixed(0))},t.showWeekFirstDay=function(){var t=new Date,e=t.getDay();e=e?e:7;var i=new Date(t-864e5*(e-1));return i},t.showWeekLastDay=function(){var e=(new Date,t.showWeekFirstDay()),i=new Date(1e3*(e/1e3+518400));return i},t.calcWeekFirstDay=function(){var t=new Date,e=t.getDay();e=e>0?e:7;var i=7-e,n=t.getHours(),r=t.getMinutes(),s=t.getSeconds(),o=86400*i*1e3+864e5-(3600*n*1e3+60*r*1e3+1e3*s);return new Date(o)},t.format_1=function(e){var i=0,n="##:##:##";return i=Math.floor(e/t.MS_PER_HOUR),n=n.replace("##",t.formatTimeNum(i)),i&&(e-=i*t.MS_PER_HOUR),i=Math.floor(e/t.MS_PER_MINUTE),n=n.replace("##",t.formatTimeNum(i)),i&&(e-=i*t.MS_PER_MINUTE),i=Math.floor(e/1e3),n=n.replace("##",t.formatTimeNum(i))},t.format_2=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),s=e.getHours(),o=e.getMinutes(),a=e.getSeconds();return i+"-"+n+"-"+r+" "+s+":"+o+":"+a},t.format_3=function(t){var e=this.format_1(t),i=e.split(":");return i[1]+":"+i[2]},t.format_4=function(t){return t<this.MS_PER_HOUR?Math.floor(t/this.MS_PER_MINUTE)+"分钟前":t<this.MS_PER_DAY?Math.floor(t/this.MS_PER_HOUR)+"小时前":Math.floor(t/this.MS_PER_DAY)+"天前"},t.format_5=function(t,e){void 0===e&&(e=2);var i="",n=["天","时","分","秒"],r=[],s=Math.floor(t/this.MS_PER_DAY);r.push(s),t-=s*this.MS_PER_DAY;var o=Math.floor(t/this.MS_PER_HOUR);r.push(o),t-=o*this.MS_PER_HOUR;var a=Math.floor(t/this.MS_PER_MINUTE);r.push(a),t-=a*this.MS_PER_MINUTE;var h=Math.floor(t/1e3);r.push(h);for(var l in r)if(r[l]>0&&(i+=this.formatTimeNum(r[l],Number(l))+n[l],e--,0>=e))break;return i},t.format_6=function(t){var e=new Date(t),i=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return this.formatTimeNum(i)+":"+this.formatTimeNum(n)+":"+this.formatTimeNum(r)},t.format_7=function(t){return t<this.MS_PER_HOUR?"<1小时":t<this.MS_PER_DAY?Math.floor(t/this.MS_PER_HOUR)+"小时":Math.floor(t/this.MS_PER_DAY)+"天"},t.format_8=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),s=e.getHours(),o=e.getMinutes();return i+"-"+n+"-"+r+" "+s+":"+o},t.format_9=function(t){var e=Math.floor(t/this.MS_PER_HOUR);t-=e*this.MS_PER_HOUR;var i=Math.floor(t/this.MS_PER_MINUTE);t-=i*this.MS_PER_MINUTE;var n=Math.floor(t/1e3);return e+"小时"+i+"分钟"+n+"秒"},t.format_10=function(t){var e=Math.floor(t/this.MS_PER_MINUTE);t-=e*this.MS_PER_MINUTE;var i=Math.floor(t/1e3);return e+"分"+i+"秒"},t.format_11=function(t){var e=Math.floor(t/this.MS_PER_HOUR);t-=e*this.MS_PER_HOUR;var i=Math.floor(t/this.MS_PER_MINUTE);t-=i*this.MS_PER_MINUTE;var n=Math.floor(t/1e3);return e+"时"+i+"分"+n+"秒"},t.format_12=function(e){var i=Math.floor(e/this.MS_PER_HOUR);e-=i*this.MS_PER_HOUR;var n=Math.floor(e/this.MS_PER_MINUTE);e-=n*this.MS_PER_MINUTE;var r=Math.floor(e/1e3);return t.formatTimeNum(i)+":"+t.formatTimeNum(n)+":"+t.formatTimeNum(r)},t.format_13=function(e){var i=new Date(e),n=(i.getFullYear(),i.getMonth()+1),r=i.getDay(),s=i.getDate(),o=i.getHours(),a=i.getMinutes();return n+"月"+s+"日(周"+this.WEEK_CN[r]+") "+t.formatTimeNum(o)+":"+t.formatTimeNum(a)},t.format_14=function(t){var e=new Date(t),i=e.getHours(),n=e.getMinutes();return i+"时"+n+"分"},t.format_15=function(e){var i=new Date(e),n=i.getMonth()+1,r=i.getDate(),s=i.getHours(),o=i.getMinutes();return t.formatTimeNum(n)+"-"+t.formatTimeNum(r)+" "+t.formatTimeNum(s)+":"+t.formatTimeNum(o)},t.formatTimeNum=function(t,e){return t>=10?t.toString():0==e?t.toString():"0"+t},t.checkTime=function(t,e){var i=(new Date).getTime(),n=t>i+e*this.MS_PER_DAY;return n},t.formatFullTime=function(t){var e,i,n=new Date(t),r=n.getFullYear(),s=n.getMonth()+1,o=n.getDate(),a=n.getDay(),h=n.getHours();i=10>h?"0"+h:h.toString();var l,c=n.getMinutes();l=10>c?"0"+c:c.toString();var u;switch(a){case 1:u="Monday";break;case 2:u="Tuesday";break;case 3:u="Wednesday";break;case 4:u="Thursday";break;case 5:u="Friday";break;case 6:u="Saturday";break;case 0:u="Sunday"}return e=r+"years"+s+"month"+o+"day（"+u+"） "+i+":"+l},t.formatStrTimeToMs=function(t){var e=new Date,i=t.split(".");e.setFullYear(i[0]),e.setMonth(+i[1]-1);var n=i[2].split("-");e.setDate(n[0]);var r=n[1].split(":");return e.setHours(r[0]),e.setMinutes(r[1]),e.setSeconds(0),e.getTime()},t.TIME_FORMAT_1=1,t.TIME_FORMAT_2=2,t.TIME_FORMAT_3=3,t.TIME_FORMAT_4=4,t.TIME_FORMAT_5=5,t.TIME_FORMAT_6=6,t.TIME_FORMAT_7=7,t.TIME_FORMAT_8=8,t.TIME_FORMAT_9=9,t.TIME_FORMAT_10=10,t.TIME_FORMAT_11=11,t.TIME_FORMAT_12=12,t.TIME_FORMAT_13=13,t.TIME_FORMAT_14=14,t.TIME_FORMAT_15=15,t.MS_PER_SECOND=1e3,t.MS_PER_MINUTE=6e4,t.MS_PER_HOUR=36e5,t.MS_PER_DAY=864e5,t.SECOND_PER_HOUR=3600,t.SECOND_PER_DAY=86400,t.SECOND_PER_MONTH=2592e3,t.SECOND_PER_YEAR=31104e3,t.DAYS_PER_WEEK=7,t.YEAR_PER_YEAR=1,t.MONTH_PER_YEAR=12,t.DAYS_PER_MONTH=30,t.HOURS_PER_DAY=24,t.MUNITE_PER_HOUR=60,t.SECOND_PER_MUNITE=60,t.SECOND_PER_SECOND=1,t.SECOND_2010=1262275200,t.mod=[t.SECOND_PER_MUNITE,t.MUNITE_PER_HOUR,t.HOURS_PER_DAY,t.DAYS_PER_MONTH,t.MONTH_PER_YEAR,t.YEAR_PER_YEAR],t.mul=[t.SECOND_PER_SECOND,t.SECOND_PER_MUNITE,t.SECOND_PER_HOUR,t.SECOND_PER_DAY,t.SECOND_PER_MONTH,t.SECOND_PER_YEAR],t.MINI_DATE_TIME_BASE=Date.UTC(2010,0)+(new Date).getTimezoneOffset()*t.MS_PER_MINUTE,t.TIME_ZONE_OFFSET=8*t.MS_PER_HOUR,t.TO_SECOND=0,t.TO_MINUTE=1,t.TO_HOUR=2,t.TO_DAY=3,t.TO_MONTH=4,t.TO_YEAR=5,t.FORMAT_1=["秒","分","时","天","月","年"],t.FORMAT_2=[":",":",":",":",":",":"],t.WEEK_CN=["日","一","二","三","四","五","六"],t.STYLE_1=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_HOUR,!1),t.STYLE_2=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_DAY,!1),t.STYLE_3=new DateStyle(t.FORMAT_2,t.TO_SECOND,t.TO_HOUR,!0),t.STYLE_4=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_MINUTE,!0),t}();__reflect(DateUtils.prototype,"DateUtils");var DebugUtils=function(){function t(){}return Object.defineProperty(t,"isDebug",{get:function(){return!0},enumerable:!0,configurable:!0}),t.log=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t.isDebug&&egret.log.apply(egret,[e].concat(i))},t.warn=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t.isDebug&&egret.warn.apply(egret,[e].concat(i))},t.error=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];egret.error.apply(egret,[t].concat(e))},t}();__reflect(DebugUtils.prototype,"DebugUtils");var debug={log:DebugUtils.log,warn:DebugUtils.warn,error:DebugUtils.error},DeviceUtils=function(){function t(){}return Object.defineProperty(t,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsQQBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsIEBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsFirefoxBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsChromeBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsSafariBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsOperaBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")},enumerable:!0,configurable:!0}),t}();__reflect(DeviceUtils.prototype,"DeviceUtils");var Dictionary=function(){function t(){this._keys=[],this._values=[]}return Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){return this._keys},enumerable:!0,configurable:!0}),t.prototype.setKeyValue=function(t,e){var i=this._keys.indexOf(t);return i>=0?void(this._values[i]=e):(this._keys.push(t),void this._values.push(e))},t.prototype.getValue=function(t){var e=this._keys.indexOf(t);return 0>e?null:this._values[e]},t.prototype.remove=function(t){var e=this._keys.indexOf(t);return e>=0?(this._keys.splice(e,1),this._values.splice(e,1),!0):!1},t.prototype.clear=function(){this._values.length=0,this._keys.length=0},t}();__reflect(Dictionary.prototype,"Dictionary");var DirUtil=function(){function t(){}return t.get8DirBy2Point=function(t,e){var i=MathUtils.getAngle(MathUtils.getRadian2(t.x,t.y,e.x,e.y));return this.angle2dir(i)},t.get4DirBy2Point=function(t,e){return t.x<e.x?t.y<e.y?3:1:t.y<e.y?5:7},t.dir2angle=function(t){return t*=45,t-=90},t.angle2dir=function(t){return-90>t&&(t+=360),Math.round((t+90)/45)%8},t.dirOpposit=function(t){return 4>t?t+4:t-4},t.get5DirBy8Dir=function(t){return t-this.isScaleX(t)},t.isScaleX=function(t){var e=2*(t-4);return 0>e&&(e=0),e},t}();__reflect(DirUtil.prototype,"DirUtil");var DisplayUtils=function(){function t(){}return t.setShakeOn=function(t){this.openShake=t},t.createBitmap=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.createEuiImage=function(t){var e=new eui.Image,i=RES.getRes(t);return e.source=i,e},t.removeFromParent=function(t){t&&null!=t.parent&&t.parent.removeChild(t)},t.shakeIt=function(e,i,n,r,s){if(void 0===r&&(r=1),void 0===s&&(s=function(){return!0}),this.openShake&&e&&!(1>r)&&s()){var o=[{anchorOffsetX:0,anchorOffsetY:-i},{anchorOffsetX:0,anchorOffsetY:+i},{anchorOffsetX:0,anchorOffsetY:0}];egret.Tween.removeTweens(e);var a=n/o.length;egret.Tween.get(e).to(o[0],a).to(o[1],a).to(o[2],a).call(function(){t.shakeIt(e,i,n,--r)},this)}},t.shakeItHeji=function(e,i,n,r,s){if(void 0===r&&(r=1),void 0===s&&(s=function(){return!0}),this.openShake&&e&&!(1>r)&&s()){var o=[{anchorOffsetX:.1*+i,anchorOffsetY:+i},{anchorOffsetX:.1*-i,anchorOffsetY:-i},{anchorOffsetX:.1*+i,anchorOffsetY:+i},{anchorOffsetX:.1*-i,anchorOffsetY:-i},{anchorOffsetX:.1*(+i>>1),anchorOffsetY:+i>>1},{anchorOffsetX:.1*(-i>>1),anchorOffsetY:-i>>1},{anchorOffsetX:.1*(+i>>2),anchorOffsetY:+i>>2},{anchorOffsetX:0,anchorOffsetY:0}];egret.Tween.removeTweens(e);var a=n/o.length;egret.Tween.get(e).to(o[0],a).to(o[1],a).to(o[2],a).to(o[3],a).to(o[4],a).to(o[5],a).to(o[6],a).to(o[7],a).call(function(){t.shakeIt(e,i,n,--r)},this)}},t.shakeItEntity=function(t,e,i,n,r){var s=this;if(void 0===n&&(n=1),void 0===r&&(r=function(){return!0}),this.openShake&&t&&!(1>n)&&r()){var o=[{anchorOffsetX:0,anchorOffsetY:-e},{anchorOffsetX:-e,anchorOffsetY:0},{anchorOffsetX:e,anchorOffsetY:0},{anchorOffsetX:0,anchorOffsetY:e},{anchorOffsetX:0,anchorOffsetY:0}];egret.Tween.removeTweens(t);var a=i/5;egret.Tween.get(t).to(o[0],a).to(o[1],a).to(o[2],a).to(o[3],a).to(o[4],a).call(function(){s.shakeIt(t,e,i,--n)},this)}},t.drawCir=function(t,e,i,n){function r(){t.graphics.clear(),t.graphics.beginFill(65535,1),t.graphics.moveTo(0,0),t.graphics.lineTo(e,0),t.graphics.drawArc(0,0,e,0,i*Math.PI/180,n),t.graphics.lineTo(0,0),t.graphics.endFill()}return null==t&&(t=new egret.Shape),r(),t},t.drawrect=function(t,e,i,n){function r(){t.graphics.clear(),t.graphics.beginFill(65535,1),t.graphics.drawRect(0,0,e,i),t.graphics.endFill()}return null==t&&(t=new egret.Shape),r(),t},t.scrollerToBottom=function(t){t.viewport.validateNow(),t.viewport.contentHeight>t.height&&(t.viewport.scrollV=t.viewport.contentHeight-t.height)},t.openShake=!0,t.shakingList={},t}();__reflect(DisplayUtils.prototype,"DisplayUtils");var FilterUtil=function(){function t(){}return Object.defineProperty(t,"grayFilter",{get:function(){return new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"grayFilter1",{get:function(){return new egret.ColorMatrixFilter([.3086,.5,.082,0,0,.3086,.5,.082,0,0,.3086,.5,.082,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ARRAY_GRAY_FILTER",{get:function(){return[t.grayFilter1]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"greenFilter",{get:function(){return new egret.ColorMatrixFilter([1,0,0,0,0,0,1,0,0,100,0,0,1,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"greenFilter1",{get:function(){return new egret.ColorMatrixFilter([.1,0,0,0,0,0,.80078125,0,0,20,0,0,-1,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ARRAY_GREEN_FILTER",{get:function(){return[t.greenFilter1]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"blurFilter",{get:function(){return new egret.BlurFilter(10,10,2)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ARRAY_BLUR_FILTER",{get:function(){return[t.blurFilter]},enumerable:!0,configurable:!0}),t}();__reflect(FilterUtil.prototype,"FilterUtil");var GlobalFun=function(){function t(){}return t.getOption=function(t){if(window.location){var e=location.search;if(""==e)return"";e=e.slice(1);for(var i=e.split("&"),n=i.length,r=0;n>r;r++){var s=i[r],o=s.split("=");if(o[0]==t)return o[1]}}return""},t.lighting=function(t,e,i){void 0===e&&(e=3394815),void 0===i&&(i=!1);var e=e,n=.8,r=35,s=35,o=2,a=3,h=i,l=!1,c=new egret.GlowFilter(e,n,r,s,o,a,h,l);t.filters=[c],egret.Tween.get(c,{loop:!0}).to({alpha:.2},1e3).to({alpha:.8},1e3)},t.shakeObj=function(t,e,i,n){this.target=t,this.initX=t.x,this.initY=t.y,this.maxDis=n,this.count=e*i,this.rate=i,this.timer.delay=1e3/i,this.timer.repeatCount=this.count,this.timer.addEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this),this.timer.reset(),this.timer.start()},t.shaking=function(){egret.Tween.removeTweens(this.target),this.target.x=this.initX-this.maxDis+Math.random()*this.maxDis*2,this.target.y=this.initY-this.maxDis+Math.random()*this.maxDis*2,egret.Tween.get(this.target).to({x:this.initX,y:this.initY},999/this.rate)},t.shakeComplete=function(){this.target&&(egret.Tween.removeTweens(this.target),this.target.x=this.initX,this.target.y=this.initY),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this)},t.stop=function(){this.shakeComplete()},t.filterToGrey=function(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]},t.clearFilters=function(t){t.filters=[]},t.sendToNativePhurse=function(t){window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.payGood&&window.webkit.messageHandlers.payGood.postMessage(JSON.stringify(t))},t.payCallBack=function(t){GameApp.pay_cbDdata=t},t.getBossCfg=function(){var t=MonsterCfg.cfgs,e=[];for(var i in t)1==t[i].type&&e.push(t[i]);return e},t.getMonsterCfg=function(){var t=MonsterCfg.cfgs,e=[];for(var i in t)2==t[i].type&&e.push(t[i]);return e},t.getCardDataFromId=function(t){var e=MonsterCfg.cfgs;for(var i in e)if(e[i].id==t)return e[i]},t.deepCopy=function(t){var e={};for(var i in t)e[i]=t[i];return e},t.getSkillGeneralCfg=function(t){var e=RebornCfg.cfg,i=null;for(var n in e)if(e[n].mid==t){e[n].id=t,i=this.deepCopy(e[n]);break}for(var n in GameApp.skillCfg)if(GameApp.skillCfg[n]&&GameApp.skillCfg[n].rebornId&&GameApp.skillCfg[n].rebornId==t){i.level=GameApp.skillCfg[n].level,i.atk=GameApp.skillCfg[n].atk,i.hp=GameApp.skillCfg[n].hp;break}return i},t.getBoxRfreshTimeSpan=function(){var t=new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1).getTime(),e=18e6;return t+e},t.getSkillCfg=function(t){var e=SkillCfg.skillCfg;for(var i in e)if(e[i].skillId==t)return e[i]},t.getIndex=function(){return 100*Math.random()>>0>50?1:-1},t.createSkillEff=function(t,e,i,n,r,s,o){var a=!0,h=["旋转雷球","龙腾","地爆","狂怒斩","凤凰展翅","双龙戏珠","践踏","霸刀斩","炎爆","裂地","雷霆万钧"],l=h[e-1],c="skilleff"+e,u=new eui.Label;if(u.size=40,u.scaleX=u.scaleY=1,u.textColor=16711680,-1==t||(c="skill_"+e),i.addChild(u),u.x=r.x,u.y=r.y-150,u.text=l,egret.Tween.get(u).to({scaleX:2,scaleY:2},600,egret.Ease.circIn).wait(500).call(function(){egret.Tween.removeTweens(u),u&&u.parent&&u.parent.removeChild(u),u=null},this),a){var p=1,g=150,d=StageUtils.inst().getWidth()-240,f=150,_=StageUtils.inst().getHeight()-100,m=new MovieClip;if(m.scaleX=m.scaleY=1,i.addChild(m),m.playFile(""+SKILL_EFF+c,n,null,!0),m.x=Math.random()*(d-g)+g>>0,m.y=Math.random()*(_-f)+f>>0,s&&o)for(var v=0;v<s.length;v++)if(s[v]&&!s[v].isDead){var E=egret.Point.distance(new egret.Point(s[v].x,s[v].y),new egret.Point(m.x,m.y));100>=E&&s[v].reduceHp(o+(.2*this.getIndex()>>0))}var y=15;104==e&&(y=30);var T=setInterval(function(){p+=1;var t=new MovieClip;if(t.scaleX=t.scaleY=.7,i.addChild(t),t.playFile(""+SKILL_EFF+c,n,null,!0),t.x=Math.random()*(d-g)+g>>0,t.y=Math.random()*(_-f)+f>>0,s&&o)for(var e=0;e<s.length;e++)if(s[e]&&!s[e].isDead){var r=egret.Point.distance(new egret.Point(s[e].x,s[e].y),new egret.Point(t.x,t.y));100>=r&&s[e].reduceHp(o)}p>=y&&clearInterval(T)},200)}},t.count=0,t.timer=new egret.Timer(1e3),t}();__reflect(GlobalFun.prototype,"GlobalFun");var KeyCode=function(){function t(){}return t.KC_1=49,t.KC_2=50,t.KC_3=51,t.KC_4=52,t.KC_5=53,t.KC_6=54,t.KC_7=55,t.KC_8=56,t.KC_9=57,t.KC_0=48,t.KC_A=65,t.KC_B=66,t.KC_C=67,t.KC_D=68,t.KC_E=69,t.KC_F=70,t.KC_G=71,t.KC_H=72,t.KC_I=73,t.KC_J=74,t.KC_K=75,t.KC_L=76,t.KC_M=77,t.KC_N=78,t.KC_O=79,t.KC_P=80,t.KC_Q=81,t.KC_R=82,t.KC_S=83,t.KC_T=84,t.KC_U=85,t.KC_V=86,t.KC_W=87,t.KC_X=88,t.KC_Y=89,t.KC_Z=90,t.KC_F1=112,t.KC_F2=113,t.KC_F3=114,t.KC_F4=115,t.KC_F5=116,t.KC_F6=117,t.KC_F7=118,t.KC_F8=119,t.KC_F9=120,t.KC_F10=121,t.KC_F11=122,t.KC_F12=123,t.KC_F13=124,t.KC_F14=125,t.KC_F15=126,t.KC_NUMPAD_0=96,t.KC_NUMPAD_1=97,t.KC_NUMPAD_2=98,t.KC_NUMPAD_3=99,t.KC_NUMPAD_4=100,t.KC_NUMPAD_5=101,t.KC_NUMPAD_6=102,t.KC_NUMPAD_7=103,t.KC_NUMPAD_8=104,t.KC_NUMPAD_9=105,t.KC_NUMPAD_MULTIPLY=106,t.KC_NUMPAD_ADD=107,t.KC_NUMPAD_ENTER=108,t.KC_NUMPAD_SUBTRACT=109,t.KC_NUMPAD_DECIMAL=110,t.KC_NUMPAD_DIVIDE=111,t.KC_BACKSPACE=8,t.KC_TAB=9,t.KC_ENTER=13,t.KC_SHIFT=16,t.KC_CONTROL=17,t.KC_ESCAPE=27,t.KC_SPACE=32,t.KC_WINDOWS=91,t.KC_MENU=93,t.KC_CAPS_LOCK=20,t.KC_NUM_LOCK=144,t.KC_SCROLL_LOCK=145,t.KC_PAUSE=19,t.KC_PAGE_UP=33,t.KC_PAGE_DOWN=34,t.KC_END=35,t.KC_HOME=36,t.KC_INSERT=45,t.KC_DELETE=46,t.KC_LEFT=37,t.KC_UP=38,t.KC_RIGHT=39,t.KC_DOWN=40,t.KC_SEMICOLON_COLON=186,t.KC_EQUAL_PLUS=187,t.KC_MINUS_UNDERLINE=189,t.KC_SLASH_QUESTIONMARK=191,t.KC_SPECIALCOMMA_EARTHWORM=192,t.KC_LEFT_BRACKET_BRACE=219,t.KC_BACKSLASH_VERTICALBAR=220,t.KC_RIGHT_BRACKET_BRACE=221,t.KC_QUOTE=222,t.KC_COMMA=188,t.KC_PERIOD=190,t}();__reflect(KeyCode.prototype,"KeyCode");var MathUtils=function(){function t(){}return t.getAngle=function(t){return 180*t/Math.PI},t.getRadian=function(t){return t/180*Math.PI},t.getRadian2=function(t,e,i,n){var r=i-t,s=n-e;return Math.atan2(s,r)},t.getDistance=function(t,e,i,n){var r=i-t,s=n-e,o=r*r+s*s;return Math.sqrt(o)},t.getDistanceByObject=function(t,e){return this.getDistance(t.x,t.y,e.x,e.y)},t.getDistanceX2ByObject=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},t.getDirMove=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var r=this.getRadian(t),s={x:0,y:0};return s.x=Math.cos(r)*e+i,s.y=Math.sin(r)*e+n,s},t.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},t.limitInteger=function(t,e){return Math.round(this.limit(t,e))},t.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},t.toInteger=function(t){return t>>0},t}();__reflect(MathUtils.prototype,"MathUtils");var md5=function(){function t(){}return t.obj_md5=function(t,e,i,n){void 0===i&&(i=[]),void 0===n&&(n=!0);var r=[];for(var s in t)r.push(s);n&&r.sort();for(var o=[],a=0;a<r.length;a++){var s=r[a];-1==i.indexOf(s)&&o.push(s+"="+t[s])}var h=o.join("&");return this.hex_md5(h+(e?"&"+e:""))},t.obj_md5_args=function(t,e,i,n,r){void 0===n&&(n=[]),void 0===r&&(r=!0);var s=[];for(var o in t)s.push(o);r&&s.sort();for(var a=[],h=0;h<s.length;h++){var o=s[h];-1==n.indexOf(o)&&a.push(o+"="+t[o])}var l=a.join("&");i&&(l+="&sign="+this.hex_md5(l+(e?"&"+e:"")));for(var h=0;h<n.length;h++){var c=n[h];l+="&"+c+"="+t[c]}return l},t.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),r=Array(16),s=0;16>s;s++)n[s]=909522486^i[s],r[s]=1549556828^i[s];var o=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(r.concat(o),640))},t.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",s=0;s<t.length;s++)i=t.charCodeAt(s),r+=n.charAt(i>>>4&15)+n.charAt(15&i);return r},t.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",r=t.length,s=0;r>s;s+=3)for(var o=t.charCodeAt(s)<<16|(r>s+1?t.charCodeAt(s+1)<<8:0)|(r>s+2?t.charCodeAt(s+2):0),a=0;4>a;a++)n+=8*s+6*a>8*t.length?this.b64pad:i.charAt(o>>>6*(3-a)&63);return n},t.rstr2any=function(t,e){var i,n,r,s,o,a=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var l=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),c=Array(l);for(n=0;l>n;n++){for(o=Array(),s=0,i=0;i<h.length;i++)s=(s<<16)+h[i],r=Math.floor(s/a),s-=r*a,(o.length>0||r>0)&&(o[o.length]=r);c[n]=s,h=o}var u="";for(i=c.length-1;i>=0;i--)u+=e.charAt(c[i]);return u},t.str2rstr_utf8=function(t){for(var e,i,n="",r=-1;++r<t.length;)e=t.charCodeAt(r),i=r+1<t.length?t.charCodeAt(r+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),r++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,r=-1732584194,s=271733878,o=0;o<t.length;o+=16){var a=i,h=n,l=r,c=s;i=this.md5_ff(i,n,r,s,t[o+0],7,-680876936),s=this.md5_ff(s,i,n,r,t[o+1],12,-389564586),r=this.md5_ff(r,s,i,n,t[o+2],17,606105819),n=this.md5_ff(n,r,s,i,t[o+3],22,-1044525330),i=this.md5_ff(i,n,r,s,t[o+4],7,-176418897),s=this.md5_ff(s,i,n,r,t[o+5],12,1200080426),r=this.md5_ff(r,s,i,n,t[o+6],17,-1473231341),n=this.md5_ff(n,r,s,i,t[o+7],22,-45705983),i=this.md5_ff(i,n,r,s,t[o+8],7,1770035416),s=this.md5_ff(s,i,n,r,t[o+9],12,-1958414417),r=this.md5_ff(r,s,i,n,t[o+10],17,-42063),n=this.md5_ff(n,r,s,i,t[o+11],22,-1990404162),i=this.md5_ff(i,n,r,s,t[o+12],7,1804603682),s=this.md5_ff(s,i,n,r,t[o+13],12,-40341101),r=this.md5_ff(r,s,i,n,t[o+14],17,-1502002290),n=this.md5_ff(n,r,s,i,t[o+15],22,1236535329),i=this.md5_gg(i,n,r,s,t[o+1],5,-165796510),s=this.md5_gg(s,i,n,r,t[o+6],9,-1069501632),r=this.md5_gg(r,s,i,n,t[o+11],14,643717713),n=this.md5_gg(n,r,s,i,t[o+0],20,-373897302),i=this.md5_gg(i,n,r,s,t[o+5],5,-701558691),s=this.md5_gg(s,i,n,r,t[o+10],9,38016083),r=this.md5_gg(r,s,i,n,t[o+15],14,-660478335),n=this.md5_gg(n,r,s,i,t[o+4],20,-405537848),i=this.md5_gg(i,n,r,s,t[o+9],5,568446438),s=this.md5_gg(s,i,n,r,t[o+14],9,-1019803690),r=this.md5_gg(r,s,i,n,t[o+3],14,-187363961),n=this.md5_gg(n,r,s,i,t[o+8],20,1163531501),i=this.md5_gg(i,n,r,s,t[o+13],5,-1444681467),s=this.md5_gg(s,i,n,r,t[o+2],9,-51403784),r=this.md5_gg(r,s,i,n,t[o+7],14,1735328473),n=this.md5_gg(n,r,s,i,t[o+12],20,-1926607734),i=this.md5_hh(i,n,r,s,t[o+5],4,-378558),s=this.md5_hh(s,i,n,r,t[o+8],11,-2022574463),r=this.md5_hh(r,s,i,n,t[o+11],16,1839030562),n=this.md5_hh(n,r,s,i,t[o+14],23,-35309556),i=this.md5_hh(i,n,r,s,t[o+1],4,-1530992060),s=this.md5_hh(s,i,n,r,t[o+4],11,1272893353),r=this.md5_hh(r,s,i,n,t[o+7],16,-155497632),n=this.md5_hh(n,r,s,i,t[o+10],23,-1094730640),i=this.md5_hh(i,n,r,s,t[o+13],4,681279174),s=this.md5_hh(s,i,n,r,t[o+0],11,-358537222),r=this.md5_hh(r,s,i,n,t[o+3],16,-722521979),n=this.md5_hh(n,r,s,i,t[o+6],23,76029189),i=this.md5_hh(i,n,r,s,t[o+9],4,-640364487),s=this.md5_hh(s,i,n,r,t[o+12],11,-421815835),r=this.md5_hh(r,s,i,n,t[o+15],16,530742520),n=this.md5_hh(n,r,s,i,t[o+2],23,-995338651),i=this.md5_ii(i,n,r,s,t[o+0],6,-198630844),s=this.md5_ii(s,i,n,r,t[o+7],10,1126891415),r=this.md5_ii(r,s,i,n,t[o+14],15,-1416354905),n=this.md5_ii(n,r,s,i,t[o+5],21,-57434055),i=this.md5_ii(i,n,r,s,t[o+12],6,1700485571),s=this.md5_ii(s,i,n,r,t[o+3],10,-1894986606),r=this.md5_ii(r,s,i,n,t[o+10],15,-1051523),n=this.md5_ii(n,r,s,i,t[o+1],21,-2054922799),i=this.md5_ii(i,n,r,s,t[o+8],6,1873313359),s=this.md5_ii(s,i,n,r,t[o+15],10,-30611744),r=this.md5_ii(r,s,i,n,t[o+6],15,-1560198380),n=this.md5_ii(n,r,s,i,t[o+13],21,1309151649),i=this.md5_ii(i,n,r,s,t[o+4],6,-145523070),s=this.md5_ii(s,i,n,r,t[o+11],10,-1120210379),r=this.md5_ii(r,s,i,n,t[o+2],15,718787259),n=this.md5_ii(n,r,s,i,t[o+9],21,-343485551),i=this.safe_add(i,a),n=this.safe_add(n,h),r=this.safe_add(r,l),s=this.safe_add(s,c)
}return[i,n,r,s]},t.md5_cmn=function(t,e,i,n,r,s){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,s)),r),i)},t.md5_ff=function(t,e,i,n,r,s,o){return this.md5_cmn(e&i|~e&n,t,e,r,s,o)},t.md5_gg=function(t,e,i,n,r,s,o){return this.md5_cmn(e&n|i&~n,t,e,r,s,o)},t.md5_hh=function(t,e,i,n,r,s,o){return this.md5_cmn(e^i^n,t,e,r,s,o)},t.md5_ii=function(t,e,i,n,r,s,o){return this.md5_cmn(i^(e|~n),t,e,r,s,o)},t.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},t.bit_rol=function(t,e){return t<<e|t>>>32-e},t.hexcase=0,t.b64pad="",t}();__reflect(md5.prototype,"md5");var PageArray=function(){function t(t,e){void 0===e&&(e=20),this.dataSource=t,this.size=e,this.currentPage=0,this.setPageData()}return Object.defineProperty(t.prototype,"length",{get:function(){return this.dataSource.length},enumerable:!0,configurable:!0}),t.prototype.setPageData=function(){this.pageData=[];for(var t=this.currentPage*this.size,e=(this.currentPage+1)*this.size,i=Math.min(this.length,e),n=t;i>n;n++)this.pageData.push(this.dataSource[n])},t.prototype.getDataSource=function(){return this.dataSource},Object.defineProperty(t.prototype,"totalPage",{get:function(){return Math.ceil(this.length/this.size)},enumerable:!0,configurable:!0}),t.prototype.havePre=function(){return 0!=this.currentPage},t.prototype.haveNext=function(){return this.currentPage<this.totalPage-1},t.prototype.prev=function(){this.currentPage--,this.setPageData()},t.prototype.next=function(){this.currentPage++,this.setPageData()},t.prototype.first=function(){this.currentPage=0,this.setPageData()},t.prototype.last=function(){this.currentPage=this.totalPage-1,this.setPageData()},t.prototype.gotoPage=function(t){this.totalPage<t||(this.currentPage=t-1,this.setPageData())},t}();__reflect(PageArray.prototype,"PageArray");var RegExpUtil=function(){function t(){}return t.LINE_BREAK=/\r+/g,t.BLANK_REG=/[\s\\]/g,t.ARGB_COLOR=/[a-fA-F0-9]{8}/,t.HTML=/<[^>]+>/g,t.DELETE_SPACE=/\s/g,t.REPLACE_STRING=/%s/g,t.NumericExp=/^\d+$/,t.NonNumericExp=/\D/,t.ActorNameExp=/^([\u4e00-\u9fa5]?\w?[^>|!@#$%&*\^\?]){1,48}$/,t}();__reflect(RegExpUtil.prototype,"RegExpUtil");var StageUtils=function(t){function e(){var i=t.call(this)||this;return null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.touchEnabled=!1,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,i.getStage().addChild(e._uiStage)),i}return __extends(e,t),e.inst=function(){var e=t.single.call(this);return e},e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return e._uiStage},e.getScaleMode=function(){if(e.isIphoneX())return egret.StageScaleMode.FIXED_WIDTH;var t=window.innerHeight/window.innerWidth,i=1.4,n=1.8,r="";return i>=t?r=egret.StageScaleMode.FIXED_HEIGHT:t>i&&n>t&&(r=egret.StageScaleMode.FIXED_WIDTH),r},e.isIphoneX=function(){return 734==window.innerWidth&&375==window.innerHeight||812==window.innerWidth&&375==window.innerHeight||896==window.innerWidth&&414==window.innerHeight||818==window.innerWidth&&414==window.innerHeight},e.init=function(){this.changeStageSize(),window.addEventListener("resize",this.changeStageSize)},e.changeStageSize=function(){var t=e.getScaleMode();this.lastOrientation!=window.orientation&&(document.body.style.height="100%",this.lastOrientation=window.orientation),e.inst().getStage().scaleMode=t},e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");var StringUtils=function(){function t(){}return t.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},t.getStringLength=function(t){for(var e=t.split(""),i=0,n=0;n<e.length;n++){var r=e[n];i+=this.isChinese(r)?2:1}return i},t.isChinese=function(t){var e=/^[\u4E00-\u9FA5]+$/;return e.test(t)?!1:!0},t.strByteLen=function(t){for(var e=0,i=t.length,n=0;i>n;n++)e+=t.charCodeAt(n)>=127?2:1;return e},t.complementByChar=function(e,i,n,r){void 0===n&&(n=" "),void 0===r&&(r=!0);var s=this.strByteLen(r?e.replace(t.HTML,""):e);return e+this.repeatStr(n,i-s)},t.repeatStr=function(t,e){for(var i="",n=0;e>n;n++)i+=t;return i},t.addColor=function(t,e){var i;return"string"==typeof e?i=String(e):"number"==typeof e&&(i=Number(e).toString(10)),'<font color="'+i+'">'+t+"</font>"},t.addColor1=function(t,e){var i=new Object;return i.style=new Object,i.text=t,i.textColor=Number(e).toString(16),i},t.substitute=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=RegExpUtil.REPLACE_STRING,r=t.match(n);if(r&&r.length)for(var s=r.length,o=0;s>o;o++)t=t.replace(r[o],e[o]);return t},t.replaceStr=function(t,e,i){if(-1==t.indexOf(e))return t;var n=t.split(e);return n[0]+i+n[1]},t.replaceStrColor=function(t,e){for(var i=t.indexOf("0x"),n=i,r="",s="";-1!=n;)r=t.substring(i,i+8),t=t.replace(r,e),i+=8,s=t.substring(i),n=s.indexOf("0x"),i+=n;return t},t.replace=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=0;n<e.length;n++)t=t.replace("%s",e[n]+"");return t},t.getStrByRegExp=function(t,e){void 0===e&&(e=/\d+/g);var i=[];t.replace(e,function(){return i.push(arguments[0]),"number"==typeof arguments[0]?arguments[0].toString():arguments[0]});return i},t.ChineseToNumber=function(e){for(var i=0,n=0,r=0,s=!1,o=e.split(""),a=0;a<o.length;a++){var h=t.chnNumCharCN[o[a]];if("undefined"!=typeof h)r=h,a===o.length-1&&(n+=r);else{var l=t.chnNameValueCN[o[a]].value;s=t.chnNameValueCN[o[a]].secUnit,s?(n=(n+r)*l,i+=n,n=0):n+=r*l,r=0}}return i+n},t.NumberToChinese=function(e){var i=0,n="",r="",s=!1,o=t.chnNumChar,a=t.chnUnitSection;if(0===e)return o[0];for(;e>0;){var h=e%1e4;s&&(r=o[0]+r),n=t.SectionToChinese(h),n+=0!==h?a[i]:a[0],r=n+r,s=1e3>h&&h>0,e=Math.floor(e/1e4),i++}return r},t.SectionToChinese=function(e){for(var i="",n="",r=0,s=!0,o=t.chnNumChar,a=t.chnUnitChar;e>0;){var h=e%10;0===h?s||(s=!0,n=o[h]+n):(s=!1,i=o[h],i+=a[r],n=i+n),r++,e=Math.floor(e/10)}return n},t.HTML=/<[^>]+>/g,t.chnNumCharCN={"零":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},t.chnNameValueCN={"十":{value:10,secUnit:!1},"百":{value:100,secUnit:!1},"千":{value:1e3,secUnit:!1},"万":{value:1e4,secUnit:!0},"亿":{value:1e8,secUnit:!0}},t.chnNumChar=["零","一","二","三","四","五","六","七","八","九"],t.chnUnitSection=["","万","亿","万亿","亿亿"],t.chnUnitChar=["","十","百","千"],t}();__reflect(StringUtils.prototype,"StringUtils");var TextFlowMaker=function(){function t(){}return t.generateTextFlow=function(e){if(!e)return(new egret.HtmlTextParser).parser("");for(var i,n=e.split("|"),r="",s=0,o=n.length;o>s;s++)r+=t.getSingleTextFlow1(n[s]);try{i=(new egret.HtmlTextParser).parser(r)}catch(a){return debug.log("错误的HTML输入"),(new egret.HtmlTextParser).parser("")}return i},t.generateTextFlow1=function(e){if(!e)return(new egret.HtmlTextParser).parser("");for(var i=e.split("|"),n=[],r=0,s=i.length;s>r;r++){var o=t.getSingleTextFlow(i[r]);o.text&&""!=o.text&&n.push(o)}return n},t.getOnlyName=function(t){if(!t)return"";var e=t.indexOf("<font"),i=t;return-1!=e&&(i=t.slice(0,e)),i},t.getSingleTextFlow1=function(e){var i=e.split("&T:",2);if(2==i.length){for(var n="<font",r=i[0].split("&"),s=void 0,o=!1,a=0,h=r.length;h>a;a++)switch(s=r[a].split(":"),s[0]){case t.STYLE_SIZE:n+=' size="'+Math.floor(+s[1])+'"';break;case t.STYLE_COLOR:n+=' color="'+Math.floor(+s[1])+'"';break;case t.UNDERLINE_TEXT:o=!0}return n+=o?"><u>"+i[1]+"</u></font>":">"+i[1]+"</font>"}return"<font>"+e+"</font>"},t.getSingleTextFlow=function(e){var i=e.split("&T:",2),n={style:{}};if(2==i.length){for(var r=(i[0],e.split("&")),s=void 0,o=0,a=r.length;a>o;o++)switch(s=r[o].split(":"),s[0]){case t.STYLE_SIZE:n.style.size=+s[1];break;case t.STYLE_COLOR:n.style.textColor=+s[1];break;case t.UNDERLINE_TEXT:n.style.underline=!0;break;case t.EVENT:n.style.href="event:"+s[1]}n.text=i[1]}else n.text=e;return n},t.getCStr=function(e){return t.numberList[e]?t.numberList[e]:""},t.STYLE_COLOR="C",t.STYLE_SIZE="S",t.PROP_TEXT="T",t.UNDERLINE_TEXT="U",t.EVENT="E",t.numberList=["Zero","One","Two","Three","Fout","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen","Twenty"],t}();__reflect(TextFlowMaker.prototype,"TextFlowMaker");var uint64=function(){function t(t){this._lowUint=0,this._highUint=0,this.value=t}return t.prototype.isEqual=function(t){return t?this._lowUint==t._lowUint&&this._highUint==t._highUint:!1},t.prototype.isGreaterThan=function(e){if(e instanceof t)return this._highUint>e._highUint||this._highUint==e._highUint&&this._lowUint>e._lowUint;var i=new t;return"string"==typeof e?(i.value=e,this.isGreaterThanOrEqual(i)):"number"==typeof e?(i.value=e.toString(),this.isGreaterThanOrEqual(i)):void 0},t.prototype.isGreaterThanOrEqual=function(e){if(e instanceof t)return this._highUint>e._highUint||this._highUint==e._highUint&&this._lowUint>=e._lowUint;var i=new t;return"string"==typeof e?(i.value=e,this.isGreaterThanOrEqual(i)):"number"==typeof e?(i.value=e.toString(),this.isGreaterThanOrEqual(i)):void 0},Object.defineProperty(t.prototype,"isZero",{get:function(){return 0==this._lowUint&&0==this._highUint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGreaterThanZero",{get:function(){return this._lowUint>0||this._highUint>0},enumerable:!0,configurable:!0}),t.prototype.writeByte=function(t){t.writeUnsignedInt(this._lowUint),t.writeUnsignedInt(this._highUint)},t.prototype.setValue=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._lowUint=t,this._highUint=e},Object.defineProperty(t.prototype,"value",{set:function(e){e instanceof egret.ByteArray?(this._lowUint=e.readUnsignedInt(),this._highUint=e.readUnsignedInt()):"string"==typeof e&&t.stringToUint64(e,10,this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueByString",{set:function(t){},enumerable:!0,configurable:!0}),t.prototype.leftMove=function(e,i){void 0===i&&(i=null),i=i||this;var n=t.LeftMoveMask[e],r=n&this._lowUint;r>>>=32-e,i._lowUint=this._lowUint<<e,i._highUint=this._highUint<<e,i._highUint=i._highUint|r},t.prototype.add=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint+e._lowUint;i._highUint=this._highUint+e._highUint,n>=t.MaxLowUint?(i._highUint++,i._lowUint=n-t.MaxLowUint):i._lowUint=n},t.prototype.subtraction=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint-e._lowUint;i._highUint=this._highUint-e._highUint,0>n?(i._highUint--,i._lowUint=n+t.MaxLowUint):i._lowUint=n},t.prototype.scale=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint*e;i._highUint=this._highUint*e,i._highUint+=Math.floor(Math.abs(n/t.MaxLowUint)),i._lowUint=n%t.MaxLowUint},t.prototype.toString=function(e){void 0===e&&(e=10);for(var i,n,r,s="",o=this._lowUint,a=this._highUint;0!=a||0!=o;)i=a%e,r=i*t.MaxLowUint+o,n=r%e,s=n+s,a=(a-i)/e,o=(r-n)/e;return s.length?s:"0"},t.stringToUint64=function(e,i,n){void 0===i&&(i=10),void 0===n&&(n=null),n=n||new t;for(var r,s,o=0,a=0,h=e.length,l=0;h>l;l++)s=parseInt(e.charAt(l)),r=o*i+s,a=a*i+Math.floor(r/t.MaxLowUint),o=r%t.MaxLowUint;return n.setValue(o,a),n},t.LeftMoveMask=[0,2147483648,1073741824,536870912,268435456,134217728,67108864,33554432,16777216,8388608,4194304,2097152,1048576,524288,262144,131072,65536,32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1],t.MaxLowUint=4294967296,t}();__reflect(uint64.prototype,"uint64");var WatcherUtil=function(){function t(){}return t.removeFromArrayCollection=function(e){e&&e.source&&e.source.length&&t.removeFromArray(e.source)},t.removeFromArray=function(e){if(e)for(var i=0,n=e;i<n.length;i++){var r=n[i];t.removeFromObject(r)}},t.removeFromObject=function(t){if(t instanceof egret.EventDispatcher){var e=t.$getEventMap(),i=e[eui.PropertyEvent.PROPERTY_CHANGE];if(i)for(var n=i.length-1;n>=0;n--){var r=i[n];r.thisObject instanceof eui.Watcher&&(r.thisObject.unwatch(),i.splice(n,1))}}else{var s=t.__listeners__;if(s&&s.length)for(var o=0;o<s.length;o+=2){var a=s[o+1];a instanceof eui.Watcher&&(a.unwatch(),o-=2)}}},t}();__reflect(WatcherUtil.prototype,"WatcherUtil");var GameMainView=function(t){function e(){var e=t.call(this)||this;return e.awardBoxGetTime=6e5,e.totalGetCount=3,e.goldGetNum=50,e.curCount=1,e.totalCount=1,e._entitys=[],e._ownEntitys=[],e._levelEntitys=[],e._singleFrame=33.3,e._curTime=0,e.actionExecStandTime=1e3,e.showBlood=!1,e.rebornids=["1000","1001","1002","1003","1004","1005","1006","1007","1008","1009"],e.extraBattle=!1,e.releaseSkill101=!1,e.releaseSkill102=!1,e.releaseSkill103=!1,e.releaseSkill104=!1,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.alpha=0,this._entitys=[],this._ownEntitys=[],this._levelEntitys=[],this.pos1.changeSize(),this.pos2.changeSize(),this.clickRect.changeSize(),this.monGroup.autoSize();for(var i=1;5>=i;i++){var n=egret.localStorage.getItem(LocalStorageEnum.SKILL_LEVEL+(100+i));n||egret.localStorage.setItem(LocalStorageEnum.SKILL_LEVEL+(100+i),"1")}var r=egret.localStorage.getItem(LocalStorageEnum.REBORNCFG);r&&(GameApp.skillCfg=JSON.parse(r));var s=[];s=s.concat(SkillCfg.skillCfg);var o=GameApp.skillCfg?!0:!1;if(!o){GameApp.skillCfg={};for(var i=0;i<s.length;i++)GameApp.skillCfg[s[i].skillId]=s[i];for(var i=0;10>i;i++){var a={skillId:1e3+i,rebornId:1,skillIcon:"skill_103_png",skillTitle:"skill_103_title_png",level:1,desc:"神将",atk:50,hp:550,atkDis:100,cost:100,skillType:1};GameApp.skillCfg[a.skillId]||(GameApp.skillCfg[a.skillId]=a)}}this.progressBar.mask=this.progressMark,this.totalHp=this.curHp=50*GameApp.level+950,this.touchEnabled=!1,this.touchChildren=!1,this.addTouchEvent(this.settingBtn,this.onSetHandler,!0),this.arraycollect=new eui.ArrayCollection,this.list.itemRenderer=SkilItem,this.list.dataProvider=this.arraycollect,this.scroller.viewport=this.list;var h=SkillCfg.skillCfg;this.arraycollect.source=h,this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTap,this),StageUtils.inst().getStage().addEventListener(StartGameEvent.CLICK_GUIDE_SKILL,this.onClickGuideSkill,this),StageUtils.inst().getStage().addEventListener(StartGameEvent.USE_GUIDE_SKILL,this.onUseGuideSkill,this),this.awardBox.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRewardGet,this),this.timer=new egret.Timer(1e3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),MessageManager.inst().addListener("start",this.onStart,this),MessageManager.inst().addListener("end",this.onStop,this),MessageManager.inst().addListener(CustomEvt.CANCLESKILLCDPAUSE,this.cancleSkillCdPause,this),this.refreshRewardBoxState();var l=this.changeTime();l&&this.timer.start(),this.goldWatcher=eui.Binding.bindHandler(GameApp,["roleGold"],this.roleGoldChange,this),this.gemWatcher=eui.Binding.bindHandler(GameApp,["roleGem"],this.roleGemChange,this),this.addGoldBtn.visible=!1,this.addTouchEvent(this.addGoldBtn,this.onaddGold,!0),this.addTouchEvent(this.upgradeBtn,this.onUpgrade,!0),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEnd,this),MessageManager.inst().addListener(CustomEvt.REDUCE_HP,this.onTowerHpReduce,this),MessageManager.inst().addListener(CustomEvt.BOSS_RELEASESKILL,this.onBossReleaseSkill,this),MessageManager.inst().addListener("closeMain",this.onCloseMain,this),this.blood.visible=!1,eui.Binding.bindHandler(GameApp,["level"],this.onLevelChange,this),this.descLab.visible=!1,this.descLab.alpha=0,this.createLevelMonster()},e.prototype.onCloseMain=function(){ViewManager.inst().close(e),ViewManager.inst().open(StartGameView)},e.prototype.onStart=function(){egret.startTick(this.execAction,this)},e.prototype.onStop=function(){egret.stopTick(this.execAction,this);for(var t=0;t<this._ownEntitys.length;t++)egret.Tween.removeTweens(this._ownEntitys[t]);for(var e=0;e<this._levelEntitys.length;e++)egret.Tween.removeTweens(this._levelEntitys[e])},e.prototype.onBegin=function(t){var e=this;if(this.releaseSkill102&&t.target==this.clickRect){if(!this.skillrelease||this.skillrelease&&102!=this.skillrelease){this.skillrelease=102,this.curItem.setCd();var i=GameApp.skillCfg[102];this.hideSkillUse(),i.buffTime&&this.showSkillUseTime(i.buffTime)}this.beginPoint=new egret.Point(t.stageX,t.stageY),this.skill102=new eui.Image("skill_102_pic_png"),this.addChild(this.skill102),this.skill102.scaleX=this.skill102.scaleY=.5,this.skill102.anchorOffsetX=this.skill102.width>>1,this.skill102.anchorOffsetY=this.skill102.height>>1,this.skill102.x=t.stageX,this.skill102.y=t.stageY,GlobalFun.lighting(this.skill102,15997667),this.interval=setInterval(function(){for(var t=0;t<e._levelEntitys.length;t++){var i=egret.Point.distance(new egret.Point(e._levelEntitys[t].x,e._levelEntitys[t].y),new egret.Point(e.skill102.x,e.skill102.y));100>=i&&(e._levelEntitys[t].reduceHp(GameApp.skillCfg[102].atk+(.2*GameApp.skillCfg[102].atk*GlobalFun.getIndex()>>0)),egret.Tween.removeTweens(e._levelEntitys[t]),e._levelEntitys[t].x-=40*Math.random()>>0,e._levelEntitys[t].isInAtk=!1)}},150)}},e.prototype.showSkillUseTime=function(t){var e=this;if(!this.skillInterval){this.skillUseGroup.visible=!0;var i=this;this.bar.mask=this.barMask;var n=0;this.proTxt.text="施法时间:"+t,this.skillInterval=setInterval(function(){n+=1;var r=300-n/t*300;e.proTxt.text="施法时间:"+(t-n),i.barMask.width=r,n>=t&&(clearInterval(i.skillInterval),i.curItem&&(i.curItem.focus=!1,i.curItem=null,i.skillrelease=null,i.releaseSkill101=i.releaseSkill102=!1,i.hideSkillUse()))},1e3)}},e.prototype.hideSkillUse=function(){this.skillUseGroup.visible=!1,this.barMask.width=300,this.skillInterval&&(clearInterval(this.skillInterval),this.skillInterval=null)},e.prototype.onEnd=function(t){this.skill102&&(this.interval&&clearInterval(this.interval),this.skill102.parent.removeChild(this.skill102),this.skill102=null)},e.prototype.onMove=function(t){if(this.skill102&&this.releaseSkill102){this.skill102.x=t.stageX,this.skill102.y=t.stageY;var e=180*Math.atan2(t.stageY-this.beginPoint.y,t.stageX-this.beginPoint.x)/Math.PI,i=0;i=e>=-30&&0>=e||e>0&&30>=e?0:e>30&&70>=e?45:e>70&&120>=e?90:e>120&&150>=e?135:e>150&&180>=e||e>-180&&-150>=e?180:e>-150&&-120>=e?225:e>-120&&-70>=e?-90:-45,this.skill102.rotation=i,this.beginPoint.x=t.stageX,this.beginPoint.y=t.stageY}else this.onEnd(null)},e.prototype.onBossReleaseSkill=function(t){var e=9*Math.random()+1>>0;GlobalFun.createSkillEff(-1,e,this,2,t.data.xy);for(var i=0;i<this._ownEntitys.length;i++){var n=GameApp.level*(10*Math.random()>>0);this._ownEntitys[i].reduceHp(n)}var r=GameApp.level*(10*Math.random()>>0);this.curHp-=r,this.onTowerHpReduce({data:{hp:r}})},e.prototype.onTowerHpReduce=function(t){var e=this;this.curHp-=t.data.hp,this.curHp<=0&&(this.curHp=0,this.progressMark.width=this.curHp/this.totalHp*277,this.gameFail()),this.showBlood||(this.showBlood=!0,this.blood.visible=!0,this.blood.alpha=0,egret.Tween.get(this.blood).to({alpha:1},600).to({alpha:0},600).to({alpha:1},600).to({alpha:0},600).call(function(){egret.Tween.removeTweens(e.blood),e.blood.visible=!1,e.showBlood=!1},this)),this.showDmg(t.data.hp),this.progressMark.width=this.curHp/this.totalHp*277},e.prototype.showDmg=function(t){var e=new eui.BitmapLabel;e.scaleX=e.scaleY=.7,e.font="dmg_fnt",this.addChild(e),e.text="-"+Math.floor(t),e.bottom=80,e.right=150+(50*Math.random()>>0),egret.Tween.get(e).to({bottom:e.bottom+100},600+(400*Math.random()>>0),egret.Ease.circIn).call(function(){egret.Tween.removeTweens(e),e&&e.parent&&e.parent.removeChild(e)},this)},e.prototype.gameFail=function(){egret.stopTick(this.execAction,this),this.timer.stop(),this.curReborns=null,GameApp.gameaEnd=!0;var t=this;this.releaseSkill101=this.releaseSkill102=this.releaseSkill103=this.releaseSkill104=!1,this.skillrelease=null,this.hideSkillUse(),this.curItem&&(this.curItem.focus=!1,this.curItem=null);var e=setTimeout(function(){clearTimeout(e),ViewManager.inst().open(BattleResultPopUp,[{state:0,cb:t.gameEnd,arg:t}])},2e3);console.log("游戏结束")},e.prototype.gameWin=function(){egret.stopTick(this.execAction,this),this.timer.stop()},e.prototype.gameEnd=function(t){this.curReborns=null,this.rebornids=["1000","1001","1002","1003","1004","1005","1006","1007","1008","1009"],egret.stopTick(this.execAction,this),egret.Tween.removeAllTweens(),this.descLab.visible=!1;for(var i=0;i<this._entitys.length;i++)this._entitys[i]&&this._entitys[i].parent&&this._entitys[i].parent.removeChild(this._entitys[i]);for(var i=0;i<this._ownEntitys.length;i++)this._ownEntitys[i]&&this._ownEntitys[i].parent&&this._ownEntitys[i].dispose();for(var i=0;i<this._levelEntitys.length;i++)this._levelEntitys[i]&&this._levelEntitys[i].parent&&this._levelEntitys[i].dispose();if(this._entitys=[],this._ownEntitys=[],this._levelEntitys=[],t==BattleResultPopUp.OPER_EXIT)ViewManager.inst().close(e),ViewManager.inst().open(StartGameView);else if(t==BattleResultPopUp.OPER_CONTINUE)this.reset();else if(t==BattleResultPopUp.OPER_NEXT){var n=this;GameApp.level+=1;for(var i=0;i<this._ownEntitys.length;i++)this._ownEntitys[i]&&this._ownEntitys[i].parent&&this._ownEntitys[i].dispose();this._entitys=[],this._ownEntitys=[],this._levelEntitys=[];var r=this.list.getChildAt(2);r.num=10;for(var s=0;s<this.list.numChildren;s++){var o=this.list.getChildAt(2);o.removeCd()}var a=setTimeout(function(){clearTimeout(a),n.showLevelTxt(function(){n.createLevelMonster(),egret.startTick(n.execAction,n)})},1200)}},e.prototype.reset=function(){for(var t=0;t<this._entitys.length;t++)this._entitys[t]&&this._entitys[t].parent&&this._entitys[t].parent.removeChild(this._entitys[t]);for(var t=0;t<this.list.numChildren;t++){var e=this.list.$children[t];e&&e.removeCd()}this.rebornids=["1000","1001","1002","1003","1004","1005","1006","1007","1008","1009"],this.curReborns=null,this._entitys=[],this._ownEntitys=[],this._levelEntitys=[],this.curCount=1,this.countNumLab.text=this.curCount+"/"+this.totalCount,this.totalHp=this.curHp=50*GameApp.level+950,this.list.$children[2].num=10,this.touchEnabled=!1,this.touchChildren=!1,this.refreshRewardBoxState();var i=this.changeTime();i&&this.timer.start(),this.blood.visible=!1,this.descLab.visible=!1,this.descLab.alpha=0,this.createLevelMonster(),this.initialize()},e.prototype.createLevelMonster=function(t){for(var e=this,i=(GameApp.level/5>>0)+1,n=this.clickRect.y+150,r=-270,s=0;i>s;s++){var o=6*Math.random()>>0,a=GlobalFun.getMonsterCfg(),h=Math.random()*a.length>>0;GameApp.level<=11&&(h=GameApp.level);var l=a[h];l.atk=2*GameApp.level+18+.2*(2*GameApp.level+18)*this.direct(),l.hp=10*GameApp.level+90+.2*(10*GameApp.level+90)*this.direct(),SoldierShapeEntity.inst().initData(o,l.model,l.id,this,{x:r,y:n},function(t){e._levelEntitys=e._levelEntitys.concat(t),e._entitys=e._entitys.concat(t)},this);var c=new SoldierEntity;this.addChild(c),c.general=!0;var u=GlobalFun.getBossCfg(),p=Math.random()*u.length>>0;GameApp.level<=9&&(p=GameApp.level-1),r-=330;var g=u[p];g.atk=5*GameApp.level+45+.2*(5*GameApp.level+45)*this.direct(),g.hp=30*GameApp.level+800+this.direct()*(30*GameApp.level+270)*.2,c.setSoldierData(-1,g.model,g),this._levelEntitys.push(c),this._entitys.push(c),c.y=this.clickRect.y+(this.clickRect.height>>1),c.x=r,r-=750}this.dealLayerRelation()},e.prototype.direct=function(){var t=100*Math.random()>>0;return t>50?1:-1},e.prototype.createOwnGenral=function(t){var e=this,i=new SoldierEntity;if(!this.curReborns||this.curReborns&&!this.curReborns.length){this.curReborns=[];for(var n in GameApp.reborns){var r=this.rebornids.indexOf(n);-1!=r&&(this.rebornids.splice(r,1),this.curReborns.push(GameApp.reborns[n]))}}var s=1;if(this.curReborns&&this.curReborns.length){var o=this.curReborns.shift();s=o[0]}var a="skill_103_"+s,h=GlobalFun.getSkillGeneralCfg(s);2==s?h.atkspd*=2:3==s?(h.atk*=2,h.hp*=2):4==s&&(h.atk*=4),i.setSoldierData(1,a,h),this.addChild(i),i.alpha=0,i.x=t.x,i.y=t.y;var l=new MovieClip;this.addChild(l),l.scaleX=l.scaleY=.8,l.playFile(EFFECT+"birth",1,null,!0),l.x=t.x,l.y=t.y,egret.Tween.get(i).to({alpha:1},600,egret.Ease.circIn).call(function(){e._ownEntitys.push(i),e._entitys.push(i)},this)},e.prototype.execAction=function(t){return this._curTime+=this._singleFrame,this._curTime>=this.actionExecStandTime&&(this._curTime=0,this.action(1),this.action(-1)),!1},e.prototype.action=function(t){for(var e,i=1==t?this._ownEntitys:this._levelEntitys,n=1==t?this._levelEntitys:this._ownEntitys,r=function(r){var o=i[r];if(o.isDead){for(var a=0;a<s._entitys.length;a++)if(s._entitys[a]==o){s._entitys.splice(a,1);break}var h=new MovieClip;return s.addChild(h),h.x=o.x,h.y=o.y,h.playFile(EFFECT+"death",1),o.dispose(),i.splice(r,1),r-=1,e=r,"continue"}if(-1==t){var l=egret.localStorage.getItem(LocalStorageEnum.IS_PASS_GUIDE);if(!l&&o.x>=100){s.onStop(),s.touchEnabled=!0,s.touchChildren=!0,egret.localStorage.setItem(LocalStorageEnum.IS_PASS_GUIDE,"1"),ViewManager.inst().open(GuideView);var c=s.list.getChildAt(2);return s.guideView=ViewManager.inst().getView(GuideView),s.guideView.nextStep({id:"1_1",comObj:c,width:75,height:75}),{value:void 0}}}var u=void 0;if(u=s.getNearByEntity(o,n),1==t?u&&u.x>=s.clickRect.x+50&&o.lookAt(u):o.isInAtk||o.lookAt(u,!0),o.isInAtkDis())o.execAtkAction();else if(!o.playState)if(o.atkTar&&!o.atkTar.isDead&&1==t){if(o.execMoveAction(),s.checkXBlock(1,o,s._ownEntitys)){var p=o.y+40*(100*Math.random()>>0>50?1:-1);p>=s.clickRect.y+s.clickRect.height||p<=s.clickRect.y?(o.execStandAction(),egret.Tween.removeTweens(o)):o.execYmoveAction(p)}}else if(-1==t){var g={x:StageUtils.inst().getWidth()-200,y:o.y};o.execMoveAction({x:g.x,y:g.y},function(){o.unlookAt(),o.isInAtk=!0},s)}else egret.Tween.removeTweens(o),o.execMoveAction({x:s.clickRect.x+s.clickRect.width-100-(150*Math.random()>>0),y:o.y});e=r},s=this,o=0;o<i.length;o++){var a=r(o);if(o=e,"object"==typeof a)return a.value}this._levelEntitys.length<=0&&(this.execNextCount(),egret.stopTick(this.execAction,this)),this.dealLayerRelation()},e.prototype.execNextCount=function(){var t=this;if(this.curCount>=this.totalCount)if(this.extraBattle){this.extraBattle=!1,egret.stopTick(this.execAction,this),this.curReborns=null,GameApp.gameaEnd=!0;var e=this;this.releaseSkill101=this.releaseSkill102=this.releaseSkill103=this.releaseSkill104=!1,this.skillrelease=null,this.hideSkillUse(),this.curItem&&(this.curItem.focus=!1,this.curItem=null);var i=setTimeout(function(){clearTimeout(i),ViewManager.inst().open(BattleResultPopUp,[{state:1,cb:e.gameEnd,arg:e}])},2e3)}else{var n=100*Math.random()>>0;if(n>=80){this.extraBattle=!0;for(var r=15*Math.random()+10>>0,s=r,o=function(e){var i=100*Math.random()>>0>50?EFFECT+"trans":EFFECT+"trans2",n=new MovieClip;n.scaleX=n.scaleY=.6,n.playFile(i,3,null,!0),a.addChild(n),n.x=Math.random()*(a.clickRect.width-350)+a.clickRect.x+80>>0,n.y=Math.random()*(a.clickRect.height-30)+a.clickRect.y+50>>0;var r=GlobalFun.getMonsterCfg(),o=Math.random()*r.length>>0,h=r[o];h.atk=2*GameApp.level+18+.2*(2*GameApp.level+18)*a.direct(),h.hp=10*GameApp.level+90+.2*(10*GameApp.level+90)*a.direct();var l=new SoldierEntity;l.setSoldierData(-1,h.model,h),a.addChild(l),l.x=n.x,l.y=n.y,l.alpha=0,egret.Tween.get(l).to({alpha:1},1e3).call(function(){t._levelEntitys.push(l),t._entitys.push(l),e>=s-1&&egret.startTick(t.execAction,t)},a)},a=this,h=0;s>h;h++)o(h)}else{for(var h=0;h<this.list.numChildren;h++){var l=this.list.$children[h];l&&l.removeCd()}this.extraBattle=!1,egret.stopTick(this.execAction,this),this.curReborns=null,GameApp.gameaEnd=!0;var c=this;this.releaseSkill101=this.releaseSkill102=this.releaseSkill103=this.releaseSkill104=!1,this.skillrelease=null,this.hideSkillUse(),this.curItem&&(this.curItem.focus=!1,this.curItem=null);var u=setTimeout(function(){clearTimeout(u),ViewManager.inst().open(BattleResultPopUp,[{state:1,cb:c.gameEnd,arg:c}])},2e3)}}else{this.curCount+=1,this.countNumLab.text=this.curCount+"/"+this.totalCount;var p=this;this.curReborns=null,this.rebornids=["1000","1001","1002","1003","1004","1005","1006","1007","1008","1009"],this.releaseSkill101=this.releaseSkill102=this.releaseSkill103=this.releaseSkill104=!1,this.skillrelease=null,this.hideSkillUse(),this.curItem&&(this.curItem.focus=!1,this.curItem=null),this.showLevelTxt(function(){p.createLevelMonster(),egret.startTick(t.execAction,t)},this.curCount)}},e.prototype.dealLayerRelation=function(){this._entitys.sort(this.sortFun);for(var t=0;t<this._entitys.length;t++)this.setChildIndex(this._entitys[t],3+t)},e.prototype.sortFun=function(t,e){var i=t.y,n=e.y;return i>n?1:n>i?-1:0},e.prototype.checkXBlock=function(t,e,i){for(var n=e.x,r=e.y,s=0;s<i.length;s++){var o=i[s];if(e!=o){var a=o.x,h=o.y;if(e.atkTar){var l=e.x>e.atkTar.x?1:-1,c=!1;if(c=1==l?40>=n-a&&n>a&&Math.abs(r-h)<=20:40>=a-n&&a>n&&Math.abs(r-h)<=20)return!0}}}return!1},e.prototype.getNearByEntity=function(t,e){var i=e.length>1?e[1]:e[0];if(i)for(var n=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),r=0;r<e.length;r++){var s=e[r],o=Math.sqrt(Math.pow(s.x-t.x,2)+Math.pow(s.y-t.y,2));n>=o&&(i=s,n=o)}return i},e.prototype.onTouchTap=function(t){if(this.releaseSkill103&&t.target==this.clickRect)this.skillrelease=103,this.hideSkillUse(),this.curItem&&(this.curItem.num?(this.createOwnGenral({x:t.stageX,y:t.stageY}),this.curItem.num-=1):UserTips.inst().showTips("已无更多的神将"));else if(this.releaseSkill101&&t.target==this.clickRect){var e=GameApp.skillCfg[101];(!this.skillrelease||this.skillrelease&&101!=this.skillrelease)&&(this.skillrelease=101,this.curItem.setCd(),this.hideSkillUse(),e.buffTime&&this.showSkillUseTime(e.buffTime));var i=new MovieClip;this.addChild(i),i.playFile(SKILL_EFF+"skill_101",1,null,!0),i.scaleX=i.scaleY=.4,i.x=t.stageX,i.y=t.stageY;for(var n=0;n<this._levelEntitys.length;n++){var r=egret.Point.distance(new egret.Point(this._levelEntitys[n].x,this._levelEntitys[n].y),new egret.Point(t.stageX,t.stageY));100>=r&&this._levelEntitys[n].reduceHp(e.atk+(e.atk*GlobalFun.getIndex()*.2>>0))}}else if(this.releaseSkill102&&t.target==this.clickRect);else if(this.releaseSkill104&&t.target==this.clickRect){if(this.curItem&&this.curItem.isCd)return;var s=GameApp.skillCfg[104];this.skillrelease=104,this.curItem.setCd(),this.hideSkillUse();var o=new MovieClip;this.addChild(o),o.x=this.pos1.x,o.y=this.pos1.y;var a=new MovieClip;this.addChild(a),a.x=this.pos2.x,a.y=this.pos2.y,o.playFile(SKILL_EFF+"skill_104_c",1,null,!0),a.playFile(SKILL_EFF+"skill_104_c",1,null,!0);var h=this,l=setTimeout(function(){clearTimeout(l),GlobalFun.createSkillEff(1,104,h,2,{x:StageUtils.inst().getWidth()-200,y:200},h._levelEntitys,s.atk),GlobalFun.shakeObj(h,7,15,5)},800)}},e.prototype.onLevelChange=function(){this.levelNumLab.text=GameApp.level.toString(),this.totalCount=(GameApp.level/GameApp.totalCount>>0)+1,this.curCount=1,this.totalCount>=GameApp.totalCount&&(this.totalCount=GameApp.totalCount),this.totalHp=this.curHp=50*GameApp.level+950,this.countNumLab.text=this.curCount+"/"+this.totalCount,this.progressMark.width=this.curHp/this.totalHp*277},e.prototype.onaddGem=function(){ViewManager.inst().open(ShopPopUp,[{selectIndex:1}]),this.pauseSkillCd()},e.prototype.onaddGold=function(){ViewManager.inst().open(ShopPopUp,[{selectIndex:0}]),this.pauseSkillCd()},e.prototype.onUpgrade=function(){ViewManager.inst().open(UpgradePopUp),this.pauseSkillCd()},e.prototype.pauseSkillCd=function(){for(var t=0;t<this.list.numChildren;t++){var e=this.list.getChildAt(t);e&&e.pauseCd()}},e.prototype.cancleSkillCdPause=function(){for(var t=0;t<this.list.numChildren;t++){var e=this.list.getChildAt(t);
e&&e.canclePause()}},e.prototype.showEffect=function(){var t=this;egret.Tween.get(this.itemGroup).to({top:4},300,egret.Ease.backOut).call(function(){egret.Tween.removeTweens(t.itemGroup)},this),egret.Tween.get(this.awardBox).to({left:17},400,egret.Ease.backOut).call(function(){egret.Tween.removeTweens(t.awardBox)},this),egret.Tween.get(this.levelGroup).to({top:14},500,egret.Ease.backOut).call(function(){egret.Tween.removeTweens(t.levelGroup)},this),egret.Tween.get(this.settingBtn).to({right:21},600,egret.Ease.backOut).call(function(){egret.Tween.removeTweens(t.settingBtn)},this),egret.Tween.get(this.upgradeBtn).to({right:17},700,egret.Ease.backOut).call(function(){egret.Tween.removeTweens(t.upgradeBtn),t.upred.right=14}),egret.Tween.get(this.skillGroup).to({right:-13},800,egret.Ease.backOut).call(function(){egret.Tween.removeTweens(t.skillGroup)},this),egret.Tween.get(this.hpGroup).to({bottom:0},900,egret.Ease.backOut).call(function(){egret.Tween.removeTweens(t.hpGroup)},this)},e.prototype.initialize=function(t){var e=this,i=egret.localStorage.getItem(LocalStorageEnum.IS_PASS_GUIDE);GameApp.gameaEnd=!1;var n=0;t?i?(this.monImg.visible=this.monGroup.visible=!1,egret.Tween.get(this).to({alpha:1},1e3).call(function(){egret.Tween.removeTweens(e),e.showEffect(),e.showText()},this)):(this.monImg.visible=!0,this.monGroup.visible=!0,egret.Tween.get(this).to({alpha:1},1e3).call(function(){egret.Tween.removeTweens(e);for(var t=e.monGroup.width-200,i=["小的们,随本王出征","列队！准备攻城!!!"],r=0;2>r;r++){var s=6*Math.random()>>0,o=GlobalFun.getMonsterCfg(),a=Math.random()*o.length>>0,h=o[a];SoldierShapeEntity.inst().initData(s,h.model,h.id,e.monGroup,{x:t-450*r,y:100},function(r){for(var s=function(s){r[s].alpha=0;r[s].y;r[s].y-=200,egret.Tween.get(r[s]).wait(150*s).to({alpha:1,y:r[s].y+200},150,egret.Ease.backOut).call(function(){if(egret.Tween.removeTweens(r[s]),s>=r.length-1)for(var o=0;o<r.length;o++)r[o].execOneTimeAtk(function(o){if(o>=r.length-1){var a=new eui.Label;e.monGroup.addChild(a),a.text=i.shift(),a.alpha=.3,a.scaleX=a.scaleY=5,a.anchorOffsetX=a.width>>1,a.anchorOffsetY=a.height>>1,a.y=0,a.x=t,egret.Tween.get(a).to({alpha:1,scaleX:1,scaleY:1},600,egret.Ease.circOut).wait(300).call(function(){egret.Tween.removeTweens(a)},e);var h=new SoldierEntity;h.alpha=0,e.monGroup.addChild(h),h.general=!0;var l=GlobalFun.getBossCfg(),c=Math.random()*l.length>>0;egret.Tween.get(h).to({alpha:1},600).call(function(){egret.Tween.removeTweens(h)},e),t-=140;var u=l[c];h.setSoldierData(-1,u.model,u),h.execOneTimeAtk(function(t){if(n+=1,n>=2){var i=new eui.Rect(StageUtils.inst().getWidth(),StageUtils.inst().getHeight(),0);e.addChild(i),i.alpha=0,egret.Tween.get(i).wait(2e3).to({alpha:.9},1e3).wait(300).call(function(){e.monGroup&&(e.monGroup.visible=!1),e.monImg&&(e.monImg.visible=!1)},e).to({alpha:0},2e3).call(function(){i.parent.removeChild(i),egret.Tween.removeTweens(i),e.showEffect(),e.showText()},e)}},e,s),h.y=200,h.x=t,t-=350}},e,o)},e)},o=0;o<r.length;o++)s(o)},e)}},this)):(this.monImg.visible=!1,this.monGroup.visible=!1,this.showEffect(),this.showText())},e.prototype.showText=function(){var t=this;this.touchEnabled=!1,this.touchChildren=!1,this.showLevelTxt(function(){var e=egret.localStorage.getItem(LocalStorageEnum.IS_PASS_GUIDE);egret.startTick(t.execAction,t),e?(t.touchEnabled=!0,t.touchChildren=!0):(t.touchEnabled=!1,t.touchChildren=!1)})},e.prototype.roleGoldChange=function(t){this.goldLab.text=GameApp.roleGold.toString();var e=!1;for(var i in GameApp.skillCfg)if(GameApp.roleGold>=GameApp.skillCfg[i].cost&&0!=GameApp.skillCfg[i].cost){e=!0;break}this.upred.visible=e},e.prototype.roleGemChange=function(t){this.gemLab.text=t.toString()},e.prototype.onClickGuideSkill=function(t){if(this.guideView){var e=(StageUtils.inst().getWidth()>>1)+100,i=StageUtils.inst().getHeight()>>1;this.curItem=this.list.$children[2],this.curItem.focus=!0,this.releaseSkill103=!0,this.guideView.nextStep({id:t.data.id,comObj:{x:e,y:i},width:75,height:75})}},e.prototype.onUseGuideSkill=function(t){console.log("使用了技能-----"+t.data.skillId+"----神将召唤"),egret.startTick(this.execAction,this);var e=(StageUtils.inst().getWidth()>>1)+100,i=(StageUtils.inst().getHeight()>>1)+50;this.createOwnGenral({x:e,y:i})},e.prototype.onRewardGet=function(t){var e=egret.localStorage.getItem(LocalStorageEnum.BOX_REWARD_GET),i=egret.localStorage.getItem(LocalStorageEnum.BOX_REWARD_TIMESPAN),n=(new Date).getTime();if(!e||e&&"0"==e||i&&n-parseInt(i)>this.awardBoxGetTime){var r=new MovieClip;this.awardBox.addChild(r),r.playFile(EFFECT+"gold",1,null,!0),r.x=this.awardBox.width>>1,r.y=this.awardBox.height>>1,GameApp.inst().gold+=this.goldGetNum,UserTips.inst().showTips("获得金币+"+this.goldGetNum);var s=egret.localStorage.getItem(LocalStorageEnum.BOX_REWARD_GET);egret.localStorage.setItem(LocalStorageEnum.BOX_REWARD_GET,(parseInt(s)+1).toString()),egret.localStorage.setItem(LocalStorageEnum.BOX_REWARD_TIMESPAN,(new Date).getTime().toString()),this.refreshRewardBoxState(1)}else UserTips.inst().showTips("未达领取时间")},e.prototype.refreshRewardBoxState=function(t){void 0===t&&(t=0),GameApp.inst().refreshTimespan();var e=egret.localStorage.getItem(LocalStorageEnum.BOX_REWARD_GET);if(e){var i=parseInt(e)+t;this.awardBox.visible=!(i>=this.totalGetCount),0==this.awardBox.visible?this.timer.stop():t&&this.timer.start()}else egret.localStorage.setItem(LocalStorageEnum.BOX_REWARD_GET,"0"),this.awardBox.visible=!0,this.boxLab.text="领取"},e.prototype.changeTime=function(){var t=egret.localStorage.getItem(LocalStorageEnum.BOX_REWARD_TIMESPAN),e=(new Date).getTime(),i=e-parseInt(t);return!t||t&&i>=this.awardBoxGetTime?(this.timer.stop(),this.boxLab.text="领取",!1):(this.boxLab.text=DateUtils.getFormatBySecond((this.awardBoxGetTime-i)/1e3,DateUtils.TIME_FORMAT_3),!0)},e.prototype.refreshPage=function(){},e.prototype.onTimer=function(){this.changeTime()},e.prototype.onSetHandler=function(){ViewManager.inst().open(SettingPopUp),this.pauseSkillCd()},e.prototype.onItemTap=function(t){var e=this,i=this.list.getChildAt(t.itemIndex);if(i.isCd)return void UserTips.inst().showTips("技能冷却中");var n=t.item.skillId,r=GlobalFun.getSkillCfg(n);if(r){if(105==r.skillId)return this.onStop(),void ViewManager.inst().open(CommonPtompt,[{cb:function(t){if(1==t)for(var i=0;i<e.list.numChildren;i++){var n=e.list.$children[i];n.removeCd(),103==n.skillId&&(n.num=10)}egret.startTick(e.execAction,e)},arg:this}]);this.descLab.visible=!0,this.descLab.alpha=0,this.descLab.text=r.desc,egret.Tween.removeTweens(this.descLab),this.timeout&&clearTimeout(this.timeout),egret.Tween.get(this.descLab,{loop:!0}).to({alpha:1},500).to({alpha:0},500);var s=this;this.timeout=setTimeout(function(){clearTimeout(s.timeout),s.descLab.visible=!1,s.descLab.alpha=0,egret.Tween.removeTweens(s.descLab)},2e3);for(var o=0;o<this.list.numChildren;o++){var a=this.list.$children[o];a.focus=!1}i.focus=!0,i.dongyixia(),this.curItem=i,103==i.skillId?(this.releaseSkill103=!0,this.releaseSkill101=this.releaseSkill102=this.releaseSkill104=!1):104==i.skillId?(this.releaseSkill104=!0,this.releaseSkill101=this.releaseSkill102=this.releaseSkill103=!1):101==i.skillId?(this.releaseSkill101=!0,this.releaseSkill102=this.releaseSkill103=this.releaseSkill104=!1):102==i.skillId&&(this.releaseSkill101=this.releaseSkill103=this.releaseSkill104=!1,this.releaseSkill102=!0)}console.log("触发了技能----"+n)},e.prototype.showLevelTxt=function(t,e){var i=new eui.Label;this.addChild(i),i.fontFamily="yt",i.size=30;var n=egret.localStorage.getItem(LocalStorageEnum.LEVEL),r=n?parseInt(n):1;i.textFlow=(new egret.HtmlTextParser).parse("第<font color=0xffff00>"+(e?e:r)+"</font>"+(e?"波":"关")),i.x=(StageUtils.inst().getWidth()>>1)-(i.width>>1)-200,i.y=StageUtils.inst().getHeight()>>1,i.alpha=0,i.scaleX=i.scaleY=0,egret.Tween.get(i).to({alpha:1,scaleX:2,scaleY:2,x:i.x+200},1e3,egret.Ease.circOut).wait(500).to({alpha:0,scaleX:0,scaleY:0,x:i.x+600},1e3,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(i),i.parent.removeChild(i),t()},this)},e.prototype.close=function(){this.removeTouchEvent(this.settingBtn,this.onSetHandler),this.removeTouchEvent(this.upgradeBtn,this.onUpgrade),MessageManager.inst().removeListener("start",this.onStart,this),MessageManager.inst().removeListener("end",this.onStop,this),MessageManager.inst().removeListener("closeMain",this.onCloseMain,this),MessageManager.inst().removeListener(CustomEvt.CANCLESKILLCDPAUSE,this.cancleSkillCdPause,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTap,this),StageUtils.inst().getStage().removeEventListener(StartGameEvent.CLICK_GUIDE_SKILL,this.onClickGuideSkill,this),StageUtils.inst().getStage().removeEventListener(StartGameEvent.USE_GUIDE_SKILL,this.onUseGuideSkill,this),this.awardBox.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRewardGet,this),MessageManager.inst().removeListener(CustomEvt.BOSS_RELEASESKILL,this.onBossReleaseSkill,this),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.goldWatcher&&this.goldWatcher.unwatch(),this.gemWatcher&&this.gemWatcher.unwatch()},e}(BaseEuiView);__reflect(GameMainView.prototype,"GameMainView"),ViewManager.inst().reg(GameMainView,LayerManager.UI_Main);var GuideView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._handMc=new MovieClip,this.addChild(this._handMc),this._handMc.touchEnabled=!1,this.rect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGuideTap,this)},e.prototype.onGuideTap=function(t){var i=this.data.id,n=GuideCfg.guidecfg,r=n[i],s=new StartGameEvent(r.event,r.param);StageUtils.inst().getStage().dispatchEvent(s),r.next||ViewManager.inst().close(e)},e.prototype.nextStep=function(t){this.data=t,this.setRect()},e.prototype.setRect=function(){if(this.data.comObj instanceof egret.DisplayObject){var t=this.data.comObj.parent.localToGlobal(this.data.comObj.x,this.data.comObj.y);40==this.data.offsetX&&50==this.data.offsetY?(this.data.offsetX=0,this.data.offsetY=0,this.rectData=[t.x+(this.data.offsetX||0),t.y+(this.data.offsetY||0),this.data.width-(this.data.offsetX||0),this.data.height]):this.rectData=[t.x+(this.data.offsetX||0),t.y+(this.data.offsetY||0),this.data.width,this.data.height]}else this.rectData=[this.data.comObj.x,this.data.comObj.y,this.data.width,this.data.height];this.rect.x=this.rectData[0],this.rect.y=this.rectData[1],this.rect.width=this.data.width,this.rect.height=this.data.height,this.setBgdSize(),this.setArrow()},e.prototype.setBgdSize=function(){var t,e,i=this.rect.x,n=this.rect.y;t=i>0?i:0,e=n+this.rect.height>0?n+this.rect.height:0,this.bg_left.width=t,this.bg_left.height=e,t=StageUtils.inst().getWidth()-i,t=0>t?0:t,this.bg_top.width=t,this.bg_top.height=n,t=StageUtils.inst().getWidth()-i-this.rect.width,t=0>t?0:t,e=StageUtils.inst().getHeight()-n,e=0>e?0:e,this.bg_right.width=t,this.bg_right.height=e,e=StageUtils.inst().getHeight()-n-this.rect.height,e=0>e?0:e,this.bg_bottom.width=i+this.rect.width,this.bg_bottom.height=e},e.prototype.setArrow=function(){this._handMc.playFile(EFFECT+"fingerClick",-1),this._handMc.x=this.rect.x+this.rect.width,this._handMc.y=this.rect.y+this.rect.height},e.prototype.close=function(){this.removeChildren(),this._handMc=null,this.rect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGuideTap,this)},e}(BaseEuiView);__reflect(GuideView.prototype,"GuideView"),ViewManager.inst().reg(GuideView,LayerManager.UI_Pop);var StartGameView=function(t){function e(){var e=t.call(this)||this;return e.clickBegin=!1,e}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];egret.Tween.removeAllTweens(),this.roleimg2.width=StageUtils.inst().getWidth(),this.roleimg2.height=StageUtils.inst().getHeight()-10,this.roleimg2.anchorOffsetX=this.roleimg2.width>>1,this.roleimg2.anchorOffsetY=this.roleimg2.height>>1,this.roleimg2.x=this.roleimg2.width>>1,this.roleimg2.y=this.roleimg2.height>>1,this.roleimg2.alpha=0,egret.Tween.get(this.roleimg2,{loop:!0}).to({alpha:1,scaleX:1.01,scaleY:1.01},500).to({alpha:0,scaleX:1,scaleY:1},500).wait(1500);var n=egret.localStorage.getItem(LocalStorageEnum.ENTER_FIRST);this.enterBtn.alpha=0,n?this.onShowBtn():(egret.localStorage.setItem(LocalStorageEnum.ENTER_FIRST,"1"),ViewManager.inst().open(StoryPopUp,[{cb:this.onShowBtn,arg:this}])),this.addTouchEvent(this.storyBtn,this.onLookStory,!0),this.addTouchEvent(this.enterBtn,this.onEnter,!0);var r="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",s="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nuniform float customUniform;\nvoid main(void) {\nvec2 uvs = vTextureCoord.xy;\nvec4 fg = texture2D(uSampler, vTextureCoord);\nfg.rgb += sin(customUniform + uvs.x * 2. + uvs.y * 2.) * 0.1;\ngl_FragColor = fg * vColor;\n}";this.customFilter1=new egret.CustomFilter(r,s,{customUniform:0}),this.filters=[this.customFilter1],this.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),SoundManager.inst().playBg(RES_AUDIO+"game.mp3");var o=(StageUtils.inst().getHeight()>>1)+100;this._interval=setInterval(function(){for(var e=100*Math.random()>>0>50?6:5,i=function(e){var i=7*Math.random()+1>>0,n="item_fire_"+i+"_png",r=new eui.Image;t.addChild(r),r.source=n,r.bottom=-50,r.x=Math.random()*StageUtils.inst().getWidth()>>0;var s=o-(150*Math.random()>>0),a=r.rotation,h=100*Math.random()>>0>50?1:-1;egret.Tween.get(r,{loop:!1,onChange:function(){a%80==0&&(h*=-1),r.scaleX-=.001,r.scaleY-=.001,a+=.3*h,r.rotation=a},onChangeObj:t}).to({bottom:s,alpha:0},5e3).call(function(){egret.Tween.removeTweens(r),t.removeChild(r)})},n=0;e>n;n++)i(n)},3e3)},e.prototype.onShowBtn=function(){var t=this;egret.Tween.get(this.enterBtn).to({alpha:1},600).call(function(){egret.Tween.removeTweens(t.enterBtn)},this)},e.prototype.onFrame=function(t){this.clickBegin?this.onReturn():(this.customFilter1.uniforms.customUniform+=.05,this.customFilter1.uniforms.customUniform>2*Math.PI&&(this.customFilter1.uniforms.customUniform=0))},e.prototype.onReturn=function(){var t=this;egret.Tween.get(this).to({alpha:0},1e3).call(function(){egret.Tween.removeTweens(t),ViewManager.inst().close(e)},this);var i=ViewManager.inst().getView(GameMainView);i||(ViewManager.inst().open(GameMainView),i=ViewManager.inst().getView(GameMainView)),i.initialize(!0)},e.prototype.onEnter=function(t){this.touchEnabled=!1,SoundManager.inst().touchBg(),this.clickBegin=!0},e.prototype.onLookStory=function(){ViewManager.inst().open(StoryPopUp)},e.prototype.close=function(){this._interval&&clearInterval(this._interval),egret.Tween.removeTweens(this.roleimg2),this.removeTouchEvent(this.storyBtn,this.onLookStory),this.removeTouchEvent(this.enterBtn,this.onEnter),this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},e}(BaseEuiView);__reflect(StartGameView.prototype,"StartGameView"),ViewManager.inst().reg(StartGameView,LayerManager.UI_Main);var RebornItem=function(t){function e(){var e=t.call(this)||this;return e.descs=["攻速暴增200%","全属性增加1倍","攻击力增幅4倍"],e.skinName="RebornItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.itemIndex+1;this.descLab.text=this.descs[this.itemIndex],t>=5&&(t=4),this.headIcon.source="reborn_"+this.data.rmodel+"_png",this.titleImg.source="reborn_title_"+this.data.rmodel+"_png",this.rebornCostLab.text=this.data.cost;var e=GameApp.reborns[this.data.skillId];e&&~e.indexOf(this.data.mid)&&(this._rebornBoo=!0,this.rebornCostLab.text="已转生"),this._cost=this.data.cost,this._id=this.data.mid},e.prototype.reborn=function(){this._rebornBoo=!0,this.rebornCostLab.text="已转生",GameApp.reborns[this.data.skillId]?GameApp.reborns[this.data.skillId].push(this.data.mid):GameApp.reborns[this.data.skillId]=[this.data.mid],egret.localStorage.setItem(LocalStorageEnum.REBORNIDS,JSON.stringify(GameApp.reborns));for(var t=GameApp.skillCfg[this.data.skillId],e=RebornCfg.cfg,i=null,n=0;n<e.length;n++)if(e[n].mid==this.data.mid){i=e[n];break}var r={skillId:this.data.skillId,rebornId:this.data.mid,skillIcon:this.icon,skillTitle:"reborn_title_"+this.data.rmodel+"_png",level:t.level,desc:i.desc,atk:5*t.level+45,hp:50*t.level+550,atkDis:100,cost:10*t.level+90,skillType:1};GameApp.skillCfg[this.data.skillId]=r,egret.localStorage.setItem(LocalStorageEnum.REBORNCFG,JSON.stringify(GameApp.skillCfg)),MessageManager.inst().dispatch(CustomEvt.REBORNSUCCESS,{skillId:this.data.skillId})},Object.defineProperty(e.prototype,"icon",{get:function(){return"reborn_head_"+(this.itemIndex+1)+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cost",{get:function(){return this._cost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ifReborn",{get:function(){return this._rebornBoo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mid",{get:function(){return this._id},enumerable:!0,configurable:!0}),e}(eui.ItemRenderer);__reflect(RebornItem.prototype,"RebornItem");var SkilItem=function(t){function e(){var e=t.call(this)||this;return e._isCd=!1,e.skinName="SkillItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.rect.visible=!1,this.numLab.visible=!1,this.data.skillIcon&&(this.skillIcon.source=this.data.skillIcon),this.data.skillTitle&&(this.skillTitle.source=this.data.skillTitle),this.data.skillId&&(this._skillId=this.data.skillId),this.cdGroup.visible=!1},e.prototype.setCd=function(){if(0!=this.data.cd){this.touchEnabled=!1,this.touchChildren=!1,this.cdGroup.visible=!0,this.cdTime.text=this.data.cd.toString(),this.count=0;var t=this;this._isCd=!0,this.cdInterval=setInterval(function(){t.count+=1,t.cdTime.text=(t.data.cd-t.count).toString(),t.count>=t.data.cd&&(clearInterval(t.cdInterval),t._isCd=!1,t.touchEnabled=!0,t.count=0,t.touchChildren=!0,t.cdGroup.visible=!1)},1e3)}},e.prototype.pauseCd=function(){this.cdInterval&&(clearInterval(this.cdInterval),this.cdInterval=null)},e.prototype.canclePause=function(){if(this.data.cd&&this.count<this.data.cd&&!this.cdInterval){var t=this;this.cdInterval=setInterval(function(){t.count+=1,t.cdTime.text=(t.data.cd-t.count).toString(),t.count>=t.data.cd&&(clearInterval(t.cdInterval),t._isCd=!1,t.count=0,t.touchEnabled=!0,t.touchChildren=!0,t.cdGroup.visible=!1)},1e3)}},e.prototype.removeCd=function(){this.cdInterval&&clearInterval(this.cdInterval),this.cdGroup.visible=!1,this.touchEnabled=!0,this.touchChildren=!0,this.count=0,this._isCd=!1,this.cdTime.text="0"},e.prototype.dongyixia=function(){var t=this;egret.Tween.get(this.itemGroup).to({rotation:this.itemGroup.rotation-5},50).to({rotation:this.itemGroup.rotation+5},50).to({rotation:this.itemGroup.rotation-5},50).to({rotation:this.itemGroup.rotation+5},50).call(function(){t.itemGroup.rotation=0,egret.Tween.removeTweens(t.itemGroup)},this)},Object.defineProperty(e.prototype,"num",{get:function(){return parseInt(this.numLab.text)},set:function(t){this.numLab.visible=!0,this.numLab.text=t.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCd",{get:function(){return this._isCd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skillId",{get:function(){return this._skillId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focus",{set:function(t){this.rect.visible=t},enumerable:!0,configurable:!0}),e}(eui.ItemRenderer);__reflect(SkilItem.prototype,"SkilItem");var UpgradeItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="UpgradeItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.rebornBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReborn,this),this.upgradeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this)},e.prototype.onReborn=function(){ViewManager.inst().open(RebornPanel,[{skillId:this._skillId}])},e.prototype.onUpgrade=function(){var t=GameApp.inst().gold;return this._curCost>t?void UserTips.inst().showTips("金币不足"):(GameApp.inst().gold-=this._curCost,GameApp.skillCfg[this._skillId].level+=1,this._skillId>=1e3?(GameApp.skillCfg[this._skillId].atk=5*GameApp.skillCfg[this._skillId].level+45,GameApp.skillCfg[this._skillId].hp=50*GameApp.skillCfg[this._skillId].level+550,GameApp.skillCfg[this._skillId].cost=10*GameApp.skillCfg[this._skillId].level+90):101==this._skillId||102==this._skillId?(101==this._skillId?GameApp.skillCfg[this._skillId].atk=GameApp.skillCfg[this._skillId].level+8:GameApp.skillCfg[this._skillId].atk=GameApp.skillCfg[this._skillId].level+6,GameApp.skillCfg[this._skillId].cost=5*GameApp.skillCfg[this._skillId].level+25):(104==this._skillId?GameApp.skillCfg[this._skillId].atk=5*GameApp.skillCfg[this._skillId].level+35:GameApp.skillCfg[this._skillId].atk=2*GameApp.skillCfg[this._skillId].level+18,GameApp.skillCfg[this._skillId].cost=10*GameApp.skillCfg[this._skillId].level+90),egret.localStorage.setItem(LocalStorageEnum.REBORNCFG,JSON.stringify(GameApp.skillCfg)),this._curCost=GameApp.skillCfg[this._skillId].cost,this.levelLab.text="Lv."+GameApp.skillCfg[this._skillId].level,this.costLab.text=this._curCost.toString(),this.atkLab.text=GameApp.skillCfg[this._skillId].atk.toString(),void UserTips.inst().showTips("升级成功"))},e.prototype.dataChanged=function(){this.refresh(this.data)},e.prototype.refresh=function(t){this.skillIcon.source=t.skillIcon,this.skillTitle.source=t.skillTitle,this.skillDesc.text=t.desc,this._skillId=t.skillId;var e=t.level;this.atkLab.text=t.atk.toString(),this._curCost=t.cost,this.costLab.text=this._curCost.toString(),GameApp.roleGold>=this._curCost&&(this.redP.visible=!0),this.levelLab.text="Lv."+e,this.rebornBtn.visible=!1,1==this.data.skillType&&(this.rebornBtn.visible=!0)},e.prototype.changeRedPointShow=function(t){this.redP.visible=t},Object.defineProperty(e.prototype,"skillId",{get:function(){return this._skillId},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.rebornBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReborn,this),this.upgradeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this)},e}(eui.ItemRenderer);__reflect(UpgradeItem.prototype,"UpgradeItem");var VirtualJoystick=function(t){function e(){var e=t.call(this)||this;return e.circleRadius=0,e.ballRadius=0,e.centerX=0,e.centerY=0,e.p1=new egret.Point,e.p2=new egret.Point,e.skinName="VirtualJoystickSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.circle.width=this.circle.height=141,this.ball.width=this.ball.height=42,this.circleRadius=this.circle.height/2,this.ballRadius=this.ball.height/2,this.centerX=this.circleRadius,this.centerY=this.circleRadius,this.ball.anchorOffsetX=this.ballRadius,this.ball.anchorOffsetY=this.ballRadius,this.ball.x=this.centerX,this.ball.y=this.centerY},e.prototype.start=function(){this.ball.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),StageUtils.inst().getStage().addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),StageUtils.inst().getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.stop=function(){this.ball.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),StageUtils.inst().getStage().removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),StageUtils.inst().getStage().removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.onTouchBegin=function(t){this.touchID=t.touchPointID,this.x=t.stageX,this.y=t.stageY,this.ball.x=this.centerX,this.ball.y=this.centerY,this.dispatchEvent(new VJEvent(VJEvent.VJ_START))},e.prototype.onTouchEnd=function(t){this.touchID==t.touchPointID&&(this.touchID=null,this.ball.x=this.centerX,this.ball.y=this.centerY,this.dispatchEvent(new VJEvent(VJEvent.VJ_END)))},e.prototype.onTouchMove=function(t){if(this.touchID==t.touchPointID){var e=this.localToGlobal(this.centerX,this.centerY);this.p2.x=t.stageX,this.p2.y=t.stageY;var i=egret.Point.distance(e,this.p2),n=Math.atan2(t.stageY-e.y,t.stageX-e.x);if(i<=this.circleRadius-this.ballRadius){var r=this.globalToLocal(t.stageX,t.stageY);this.ball.x=r.x,this.ball.y=r.y}else this.ball.x=Math.cos(n)*(this.circleRadius-this.ballRadius)+this.centerX,this.ball.y=Math.sin(n)*(this.circleRadius-this.ballRadius)+this.centerY;this.dispatchEvent(new VJEvent(VJEvent.VJ_MOVE,!1,n))}},e.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},e}(eui.Component);__reflect(VirtualJoystick.prototype,"VirtualJoystick");var BattleResultPopUp=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=StageUtils.inst().getWidth()/1136;this.winIcon.autoSize(),this.resultImg.autoSize(),this.resultImg2.autoSize(),this.rewardGroup.autoSize(),this.nextBtn.autoSize(),this.continueBtn.autoSize(),this.exitBtn.autoSize(),this.rewardGroup.alpha=0,this.winIcon.alpha=0,this.winIcon.scaleX=this.winIcon.scaleY=5,this.resultImg.alpha=0,this.resultImg.scaleX=this.resultImg.scaleY=5,this.resultImg2.alpha=0,this.resultImg2.scaleX=this.resultImg2.scaleY=5,1==e[0].state?(this._state="win",this.invalidateState(),this.goldNum=100+(20*Math.random()>>0),egret.Tween.get(this.winIcon).to({alpha:1,scaleX:.7,scaleY:.7},300,egret.Ease.circIn).call(function(){egret.Tween.removeTweens(t.winIcon),egret.Tween.get(t.resultImg).to({alpha:1,scaleX:n,scaleY:n},300,egret.Ease.circIn).call(function(){egret.Tween.removeTweens(t.resultImg),egret.Tween.get(t.rewardGroup).to({alpha:1},300).call(function(){egret.Tween.removeTweens(t.rewardGroup)},t)},t)},this)):(this._state="fail",this.invalidateState(),egret.Tween.get(this.winIcon).to({alpha:1,scaleX:.7,scaleY:.7},300,egret.Ease.circIn).call(function(){egret.Tween.removeTweens(t.winIcon),egret.Tween.get(t.resultImg2).to({alpha:1,scaleX:n,scaleY:n},300,egret.Ease.circIn).call(function(){egret.Tween.removeTweens(t.resultImg2),egret.Tween.get(t.rewardGroup).to({alpha:1},300).call(function(){egret.Tween.removeTweens(t.rewardGroup)},t)},t)},this),this.goldNum=12+(10*Math.random()>>0)),e[0].time,e[0].cb&&(this._cb=e[0].cb),e[0].arg&&(this._arg=e[0].arg),this.goldNumLab.text=this.goldNum.toString(),GameApp.inst().gold+=this.goldNum,this.addTouchEvent(this.nextBtn,this.onNextLevel,!0),this.addTouchEvent(this.continueBtn,this.onContinue,!0),this.addTouchEvent(this.exitBtn,this.onExit,!0)},e.prototype.getCurrentState=function(){return this._state},e.prototype.onNextLevel=function(){this._param=e.OPER_NEXT,this.onReturn()},e.prototype.onContinue=function(){this._param=e.OPER_CONTINUE,this.onReturn()},e.prototype.onExit=function(){this._param=e.OPER_EXIT,this.onReturn()},e.prototype.onReturn=function(){var t=this;egret.Tween.get(this).to({alpha:0},300,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t),ViewManager.inst().close(e),t._cb&&t._arg&&t._cb.call(t._arg,t._param)})},e.prototype.close=function(){this.removeTouchEvent(this.nextBtn,this.onNextLevel),this.removeTouchEvent(this.continueBtn,this.onContinue),this.removeTouchEvent(this.exitBtn,this.onExit)},e.OPER_CONTINUE=1,e.OPER_NEXT=2,e.OPER_EXIT=3,e}(BaseEuiView);__reflect(BattleResultPopUp.prototype,"BattleResultPopUp"),ViewManager.inst().reg(BattleResultPopUp,LayerManager.UI_Pop);var CommonPtompt=function(t){function e(){var e=t.call(this)||this;return e.oper=0,e}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.tipGroup.alpha=0,this.tipGroup.scaleX=this.tipGroup.scaleY=0,egret.Tween.get(this.tipGroup).to({alpha:1,scaleX:1,scaleY:1},600,egret.Ease.backOut).call(function(){egret.Tween.removeTweens(t.tipGroup)},this),this.addTouchEvent(this.cancleBtn,this.onReturn,!0),this.addTouchEvent(this.sureBtn,this.onSure,!0),this.addTouchEvent(this.returnBtn,this.onReturn,!0),e[0]&&(e[0].cb&&(this._cb=e[0].cb),e[0].arg&&(this._arg=e[0].arg))},e.prototype.onSure=function(){return GameApp.roleGold<200?void UserTips.inst().showTips("金币不足"):(this.oper=1,GameApp.roleGold-=200,UserTips.inst().showTips("刷新成功"),void this.onReturn())},e.prototype.onReturn=function(){var t=this;egret.Tween.get(this.tipGroup).to({alpha:0,scaleX:0,scaleY:0},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.tipGroup),ViewManager.inst().close(e),t._cb&&t._arg&&t._cb.call(t._arg,t.oper)},this)},e.prototype.close=function(){this.removeTouchEvent(this.cancleBtn,this.onReturn),this.removeTouchEvent(this.sureBtn,this.onSure),this.removeTouchEvent(this.returnBtn,this.onReturn)},e}(BaseEuiView);__reflect(CommonPtompt.prototype,"CommonPtompt"),ViewManager.inst().reg(CommonPtompt,LayerManager.UI_Pop);var RebornPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];egret.Tween.get(this.rebornGroup).to({left:10},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.rebornGroup)}),this.rect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReturn,this),this.addTouchEvent(this.btnReturn,this.onReturn,!0),this.arrayCollect=new eui.ArrayCollection,this.list.itemRenderer=RebornItem,this.list.dataProvider=this.arrayCollect,this.scroller.viewport=this.list,this.scroller.horizontalScrollBar.autoVisibility=!1,this.scroller.horizontalScrollBar.visible=!1;var n=[];this._skillId=e[0].skillId;var r=RebornCfg.cfg;for(var s in r)if(0!=r[s].cost){var o=r[s];o.skillId=this._skillId,n.push(o)}this.arrayCollect.source=n,this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTap,this)},e.prototype.onItemTap=function(t){var e=this.list.getChildAt(t.itemIndex);if(e.ifReborn){UserTips.inst().showTips("已切换转生职业");for(var i=GameApp.skillCfg[this._skillId],n=RebornCfg.cfg,r=null,s=0;s<n.length;s++)if(n[s].mid==e.mid){r=n[s];break}var o={skillId:this._skillId,rebornId:e.mid,skillIcon:e.icon,skillTitle:"reborn_title_"+r.rmodel+"_png",level:i.level,desc:r.desc,atk:5*i.level+45,hp:50*i.level+550,atkDis:100,cost:10*i.level+90,skillType:1};return GameApp.skillCfg[this._skillId]=o,void egret.localStorage.setItem(LocalStorageEnum.REBORNCFG,JSON.stringify(GameApp.skillCfg))}ViewManager.inst().open(RebornTipPopUp,[{cost:e.cost,mid:e.mid,skillId:this._skillId,cb:function(t){t&&e.reborn()},arg:this}])},e.prototype.onReturn=function(){var t=this;egret.Tween.get(this.rebornGroup).to({left:-500},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.rebornGroup),ViewManager.inst().close(e)})},e.prototype.close=function(){this.removeTouchEvent(this.btnReturn,this.onReturn),this.rect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReturn,this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTap,this)},e}(BaseEuiView);__reflect(RebornPanel.prototype,"RebornPanel"),ViewManager.inst().reg(RebornPanel,LayerManager.UI_Pop);var RebornTipPopUp=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];egret.Tween.get(this.content).to({verticalCenter:0},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t)},this),this.addTouchEvent(this.returnBtn,this.onReturn,!0),this.addTouchEvent(this.sureBtn,this.onSure,!0),this.addTouchEvent(this.cancleBtn,this.onCancle,!0),e&&e.length&&(e[0].cost&&(this._cost=e[0].cost,this.costLab.text=this._cost.toString()),e[0].mid&&(this._mid=e[0].mid),e[0].skillId&&(this._skillid=e[0].skillId),e[0].cb&&(this._cb=e[0].cb),e[0].arg&&(this._arg=e[0].arg))
},e.prototype.onSure=function(){var t=GameApp.inst().gold;if(this._cost){if(this._param=1,this._cost>t)return this._param=0,void UserTips.inst().showTips("金币不足");this._param=1,GameApp.inst().gold-=this._cost,UserTips.inst().showTips("转生成功"),this._cb&&this._arg&&this._cb.call(this._arg)}else this._param=-1;this.onReturn()},e.prototype.onCancle=function(){this._param=0,this.onReturn()},e.prototype.onReturn=function(){var t=this;egret.Tween.get(this.content).to({verticalCenter:-500},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.content),ViewManager.inst().close(e),t._cb&&t._arg&&t._cb.call(t._arg,t._param)},this)},e.prototype.close=function(){this.removeTouchEvent(this.returnBtn,this.onReturn),this.removeTouchEvent(this.sureBtn,this.onSure),this.removeTouchEvent(this.cancleBtn,this.onCancle)},e}(BaseEuiView);__reflect(RebornTipPopUp.prototype,"RebornTipPopUp"),ViewManager.inst().reg(RebornTipPopUp,LayerManager.UI_Pop);var SettingPopUp=function(t){function e(){var e=t.call(this)||this;return e._barWidth=139,e._minx=0,e._maxx=0,e.musicTouch=!1,e.effectTouch=!1,e}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];MessageManager.inst().dispatch("end"),egret.Tween.get(this.content).to({verticalCenter:0},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.content)},this),this.musicBar.mask=this.musicBarMask,this.effectBar.mask=this.effectBarMask,this._minx=this.musicBar.x,this._maxx=this.musicBar.x+this.musicBar.width,this.musicBarMask.width=this._barWidth*GameApp.bgMusic,this.m_sound_control.x=this.musicBarMask.x+this.musicBarMask.width,SoundManager.inst().setBgVolume(GameApp.bgMusic),this.effectBarMask.width=this._barWidth*GameApp.effectMusic,this.e_sound_control.x=this.effectBarMask.x+this.effectBarMask.width,SoundManager.inst().setEffectVolume(GameApp.effectMusic),this.m_sound_control.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onMusicTouchBegin,this),StageUtils.inst().getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMusicTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onMusicTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onMusicTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onMusicTouchEnd,this),this.e_sound_control.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onEffectTouchBegin,this),this.addTouchEvent(this.btnClose,this.onReturn,!0),this.addTouchEvent(this.continueBtn,this.onReturn,!0),this.addTouchEvent(this.exitBtn,this.onExit,!0)},e.prototype.onExit=function(){this.onReturn(null,!0)},e.prototype.onReturn=function(t,i){var n=this;void 0===i&&(i=!1);var r=this,s=setTimeout(function(){clearTimeout(s),r.rect.alpha=0},300);egret.Tween.get(this.content).to({verticalCenter:-500},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(n.content),ViewManager.inst().close(e),i?MessageManager.inst().dispatch("closeMain"):(MessageManager.inst().dispatch("start"),ViewManager.inst().open(GameMainView),MessageManager.inst().dispatch(CustomEvt.CANCLESKILLCDPAUSE))},this)},e.prototype.onMusicTouchBegin=function(t){this.musicTouch=!0},e.prototype.onMusicTouchMove=function(t){var e=this.content.globalToLocal(t.stageX,t.stageY);e.x<=this._minx&&(e.x=this._minx),e.x>=this._maxx&&(e.x=this._maxx);var i=(e.x-this.musicBar.x)/this._barWidth;this.musicTouch&&(this.m_sound_control.x=e.x,this.musicBarMask.width=this._barWidth*i,GameApp.bgMusic=i,SoundManager.inst().setBgVolume(i)),this.effectTouch&&(this.e_sound_control.x=e.x,this.effectBarMask.width=this._barWidth*i,GameApp.effectMusic=i,SoundManager.inst().setEffectVolume(i))},e.prototype.onMusicTouchEnd=function(){this.musicTouch&&(this.musicTouch=!1),this.effectTouch&&(this.effectTouch=!1)},e.prototype.onEffectTouchBegin=function(){this.effectTouch=!0},e.prototype.close=function(){this.m_sound_control.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onMusicTouchBegin,this),StageUtils.inst().getStage().removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMusicTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onMusicTouchEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onMusicTouchEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onMusicTouchEnd,this),this.removeTouchEvent(this.btnClose,this.onReturn),this.removeTouchEvent(this.continueBtn,this.onReturn),this.removeTouchEvent(this.exitBtn,this.onExit),this.e_sound_control.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onEffectTouchBegin,this)},e}(BaseEuiView);__reflect(SettingPopUp.prototype,"SettingPopUp"),ViewManager.inst().reg(SettingPopUp,LayerManager.UI_Pop);var ShopItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShopItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuy,this)},e.prototype.onBuy=function(){recharge.sendToNativePhurse({Key1:this.data.costNum.toString()},function(t){GameApp.roleGold+=parseInt(t)},this)},e.prototype.dataChanged=function(){this.data.cost&&(this.costLab.text=this.data.cost+"元"),this.data.desc&&(this.desc.text=this.data.desc),this.data.icon_title&&(this.icon_title.source=this.data.icon_title),this.data.icon&&(this.icon.source=this.data.icon),this.data.shopId&&(this.shopId=this.data.shopId),this.data.costNum&&(this.costNum=this.data.costNum)},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuy,this)},e}(eui.ItemRenderer);__reflect(ShopItem.prototype,"ShopItem");var ShopPopUp=function(t){function e(){var e=t.call(this)||this;return e.selectIndex=0,e.dataArr=[],e}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];MessageManager.inst().dispatch("end");var n=StageUtils.inst().getWidth()/1334;this.content.scaleX=this.content.scaleY=n,egret.Tween.get(this.content).to({verticalCenter:0},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.content)},this),this.arrayCollect=new eui.ArrayCollection,this.list.itemRenderer=ShopItem,this.list.dataProvider=this.arrayCollect,this.scroller.viewport=this.list,e&&e.length&&(this.selectIndex=e[0].selectIndex),this.refreshDataANDview(),this.addTouchEvent(this.returnBtn,this.onReturn,!0)},e.prototype.onReturn=function(){var t=this,i=this,n=setTimeout(function(){clearTimeout(n),i.rect.alpha=0},300);egret.Tween.get(this.content).to({verticalCenter:-600},600,egret.Ease.circOut).call(function(){MessageManager.inst().dispatch("start"),egret.Tween.removeTweens(t.content),ViewManager.inst().close(e),MessageManager.inst().dispatch(CustomEvt.CANCLESKILLCDPAUSE)},this)},e.prototype.onClickGold=function(){this.selectIndex=0,this.refreshDataANDview()},e.prototype.onClickGem=function(){this.selectIndex=1,this.refreshDataANDview()},e.prototype.refreshDataANDview=function(){this.dataArr=[];var t=ShopCfg.shopCfg[this.selectIndex];this.dataArr=t,this.arrayCollect.source=this.dataArr,this.list.dataProviderRefreshed()},e.prototype.close=function(){this.removeTouchEvent(this.returnBtn,this.onReturn)},e}(BaseEuiView);__reflect(ShopPopUp.prototype,"ShopPopUp"),ViewManager.inst().reg(ShopPopUp,LayerManager.UI_Pop);var StoryPopUp=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.font.mask=this.fontMask,this.fontMask.width=0,e[0]&&(this._cb=e[0].cb,this._arg=e[0].arg),egret.Tween.get(this.content).to({verticalCenter:0},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.content),egret.Tween.get(t.fontMask).to({width:734},3e4).call(function(){egret.Tween.removeTweens(t.fontMask)},t)},this),this.addTouchEvent(this.returnBtn,this.onReturn,!0)},e.prototype.onReturn=function(){var t=this;egret.Tween.get(this.content).to({verticalCenter:-600},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.content),ViewManager.inst().close(e),t._cb&&t._arg&&t._cb.call(t._arg)},this)},e.prototype.close=function(){this.removeTouchEvent(this.returnBtn,this.onReturn)},e}(BaseEuiView);__reflect(StoryPopUp.prototype,"StoryPopUp"),ViewManager.inst().reg(StoryPopUp,LayerManager.UI_Pop);var UpgradePopUp=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];MessageManager.inst().dispatch("end"),egret.Tween.get(this.upgradeGroup).to({right:0},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.upgradeGroup)},this),this.arraycollect=new eui.ArrayCollection,this.list.itemRenderer=UpgradeItem,this.list.dataProvider=this.arraycollect,this.scroller.viewport=this.list;var n=[];n=n.concat(SkillCfg.skillCfg),n.splice(2,1),n.pop();var r=GameApp.skillCfg?!0:!1;r||(GameApp.skillCfg={});for(var s=0;s<n.length;s++)GameApp.skillCfg[n[s].skillId]?n[s]=GameApp.skillCfg[n[s].skillId]:GameApp.skillCfg[n[s].skillId]=n[s];for(var s=0;10>s;s++){var o={skillId:1e3+s,rebornId:1,skillIcon:"skill_103_png",skillTitle:"skill_103_title_png",level:1,desc:"神将",atk:50,hp:550,atkDis:100,cost:100,skillType:1};GameApp.skillCfg[o.skillId]?o=GameApp.skillCfg[o.skillId]:GameApp.skillCfg[o.skillId]=o,n.push(o)}r||egret.localStorage.setItem(LocalStorageEnum.REBORNCFG,JSON.stringify(GameApp.skillCfg)),this.arraycollect.source=n,this.addTouchEvent(this.btnClose,this.onReturn,!0),this.rect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReturn,this),MessageManager.inst().addListener(CustomEvt.REBORNSUCCESS,this.onReborn,this),this.watcher=eui.Binding.bindHandler(GameApp,["roleGold"],this.onGoldChange,this)},e.prototype.onGoldChange=function(){for(var t=this.arraycollect.source,e=0;e<t.length;e++){var i=this.list.$children[e];i&&i.changeRedPointShow(GameApp.roleGold>=t[e].cost)}},e.prototype.onReborn=function(t){for(var e=0;e<this.list.$children.length;e++){var i=this.list.$children[e];if(i.skillId==t.data.skillId){i.refresh(GameApp.skillCfg[t.data.skillId]);break}}},e.prototype.onReturn=function(){var t=this,i=this,n=setTimeout(function(){clearTimeout(n),i.rect.alpha=0},300);egret.Tween.get(this.upgradeGroup).to({right:-500},600,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(t.upgradeGroup),ViewManager.inst().close(e),MessageManager.inst().dispatch("start"),MessageManager.inst().dispatch(CustomEvt.CANCLESKILLCDPAUSE)},this)},e.prototype.close=function(){this.removeTouchEvent(this.btnClose,this.onReturn),this.rect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReturn,this),this.watcher&&this.watcher.unwatch(),MessageManager.inst().removeListener(CustomEvt.REBORNSUCCESS,this.onReborn,this);for(var t=this.list.$children.length,e=0;t>e;e++){var i=this.list.getChildAt(e);i&&i.dispose()}},e}(BaseEuiView);__reflect(UpgradePopUp.prototype,"UpgradePopUp"),ViewManager.inst().reg(UpgradePopUp,LayerManager.UI_Pop);var UserTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.inst=function(){var e=t.single.call(this);return e},Object.defineProperty(e.prototype,"view",{get:function(){return this._view&&this._view.parent||(ViewManager.inst().open(TipsView),this._view=ViewManager.inst().getView(TipsView)),this._view},enumerable:!0,configurable:!0}),e.prototype.showTips=function(t,e){DelayOptManager.inst().addDelayOptFunction(this.view,this.view.showTips,t)},e}(BaseClass);__reflect(UserTips.prototype,"UserTips");var TipsItem=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.skinName="TipsSkin",e.lab.stroke=1,e.lab.strokeColor=0,e}return __extends(e,t),e.prototype.setIndex=function(t){this.index=t},Object.defineProperty(e.prototype,"labelText",{get:function(){return this._labelText},set:function(t){this._labelText=t,this.lab.textFlow=TextFlowMaker.generateTextFlow(this._labelText),this.lab.alpha=1,this.lab.verticalCenter=-1,this.pic.width=this.lab.width+20,this.addToEvent||(this.addToEvent=!0,TimerManager.inst().doTimer(2e3,1,this.removeFromParent,this))},enumerable:!0,configurable:!0}),e.prototype.removeFromParent=function(){this.addToEvent=!1,DisplayUtils.removeFromParent(this),egret.Tween.removeTweens(this)},e}(BaseView);__reflect(TipsItem.prototype,"TipsItem");var TipsView=function(t){function e(){var e=t.call(this)||this;return e.labCount=0,e.list=[],e.initUI(),e}return __extends(e,t),e.prototype.close=function(){},e.prototype.initUI=function(){this.touchChildren=!1,this.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.showTips=function(t){var e=new TipsItem;e.horizontalCenter=0;var i=(StageUtils.inst().getHeight()>>1)+120;e.bottom=i,this.addChild(e),e.labelText=t,this.list.unshift(e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeTipsItem,this);for(var n=this.list.length-1;n>=0;n--){egret.Tween.removeTweens(this.list[n]);var r=egret.Tween.get(this.list[n]);r.to({bottom:i+30*n},300)}},e.prototype.removeTipsItem=function(t){var e=t.currentTarget;e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeTipsItem,this),e.left=0/0,e.bottom=0/0;var i=this.list.indexOf(e);this.list.splice(i,1)},e}(BaseEuiView);__reflect(TipsView.prototype,"TipsView"),ViewManager.inst().reg(TipsView,LayerManager.TIPS_LAYER);var CardVo=function(){function t(){}return t}();__reflect(CardVo.prototype,"CardVo"),window.Main=Main;